<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.555">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Eugene Toh">
<meta name="dcterms.date" content="2024-10-28">

<title>IS415-GAA - Take Home Exercise 3</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">IS415-GAA</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-hands-on-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Hands-on Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-hands-on-exercise">    
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex01/Hands-on_Ex01.html">
 <span class="dropdown-text">Hands-on Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex02/Hands-on_Ex02.html">
 <span class="dropdown-text">Hands-on Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex03/Hands-on_Ex03.html">
 <span class="dropdown-text">Hands-on Exercise 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex04/Hands-on_Ex04.html">
 <span class="dropdown-text">Hands-on Exercise 4</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex05/Hands-on_Ex05.html">
 <span class="dropdown-text">Hands-on Exercise 5</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex06/Hands-on_Ex06.html">
 <span class="dropdown-text">Hands-on Exercise 6</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex07/Hands-on_Ex07.html">
 <span class="dropdown-text">Hands-on Exercise 7/8</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex09/Hands-on_Ex09.html">
 <span class="dropdown-text">Hands-on Exercise 11</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-in-class-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">In-class Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-in-class-exercise">    
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex01/In-class_Ex01.html">
 <span class="dropdown-text">In-class Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex02/In-class_Ex02.html">
 <span class="dropdown-text">In-class Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex03/In-class_Ex03.html">
 <span class="dropdown-text">In-class Exercise 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex04/In-class_Ex04.html">
 <span class="dropdown-text">In-class Exercise 4</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex05/In-class_Ex05.html">
 <span class="dropdown-text">In-class Exercise 5</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex06/In-class_Ex06.html">
 <span class="dropdown-text">In-class Exercise 6</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex07/In-class_Ex07.html">
 <span class="dropdown-text">In-class Exercise 7</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex08/In-class_Ex08.html">
 <span class="dropdown-text">In-class Exercise 8</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex10/In-class_Ex10.html">
 <span class="dropdown-text">In-class Exercise 10</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex11/In-class_Ex11.html">
 <span class="dropdown-text">In-class Exercise 11</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-take-home-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Take Home Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-take-home-exercise">    
        <li>
    <a class="dropdown-item" href="../../Take-home_Ex/Take-home_Ex01/Take-home_Ex01.html">
 <span class="dropdown-text">Take Home Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Take-home_Ex/Take-home_Ex02/Take-home_Ex02.html">
 <span class="dropdown-text">Take Home Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Take-home_Ex/Take-home_Ex03/Take-home_Ex03.html">
 <span class="dropdown-text">Take Home Exercise 3</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../Notes/notes.html"> 
<span class="menu-text">Notes</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#main-data-processing" id="toc-main-data-processing" class="nav-link active" data-scroll-target="#main-data-processing">Main data processing</a>
  <ul class="collapse">
  <li><a href="#import-dependencies" id="toc-import-dependencies" class="nav-link" data-scroll-target="#import-dependencies">Import dependencies</a></li>
  <li><a href="#import-data" id="toc-import-data" class="nav-link" data-scroll-target="#import-data">Import data</a></li>
  <li><a href="#data-wrangling" id="toc-data-wrangling" class="nav-link" data-scroll-target="#data-wrangling">Data wrangling</a></li>
  </ul></li>
  <li><a href="#are-the-number-of-cases-of-drug-related-incidents-in-philippines-affected-by-location-or-do-they-stay-the-same-no-matter-where-you-are-in-the-country" id="toc-are-the-number-of-cases-of-drug-related-incidents-in-philippines-affected-by-location-or-do-they-stay-the-same-no-matter-where-you-are-in-the-country" class="nav-link" data-scroll-target="#are-the-number-of-cases-of-drug-related-incidents-in-philippines-affected-by-location-or-do-they-stay-the-same-no-matter-where-you-are-in-the-country">Are the number of cases of drug related incidents in Philippines affected by location, or do they stay the same no matter where you are in the country?</a>
  <ul class="collapse">
  <li><a href="#data-wrangling-1" id="toc-data-wrangling-1" class="nav-link" data-scroll-target="#data-wrangling-1">Data wrangling</a></li>
  <li><a href="#analysis" id="toc-analysis" class="nav-link" data-scroll-target="#analysis">Analysis</a>
  <ul class="collapse">
  <li><a href="#data-wrangling-2" id="toc-data-wrangling-2" class="nav-link" data-scroll-target="#data-wrangling-2">Data wrangling</a></li>
  <li><a href="#morans-i" id="toc-morans-i" class="nav-link" data-scroll-target="#morans-i">Moran’s I</a></li>
  <li><a href="#gearys-c" id="toc-gearys-c" class="nav-link" data-scroll-target="#gearys-c">Geary’s C</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#where-are-the-main-areas-of-concentrated-drug-abuse-and-are-there-any-unusual-patterns-or-high-risk-spots" id="toc-where-are-the-main-areas-of-concentrated-drug-abuse-and-are-there-any-unusual-patterns-or-high-risk-spots" class="nav-link" data-scroll-target="#where-are-the-main-areas-of-concentrated-drug-abuse-and-are-there-any-unusual-patterns-or-high-risk-spots">Where are the main areas of concentrated drug abuse, and are there any unusual patterns or high-risk spots?</a>
  <ul class="collapse">
  <li><a href="#analysis-1" id="toc-analysis-1" class="nav-link" data-scroll-target="#analysis-1">Analysis</a>
  <ul class="collapse">
  <li><a href="#local-indicators-of-spatial-association-lisa---anselins-local-morans-i" id="toc-local-indicators-of-spatial-association-lisa---anselins-local-morans-i" class="nav-link" data-scroll-target="#local-indicators-of-spatial-association-lisa---anselins-local-morans-i">Local Indicators of Spatial Association (LISA) - Anselin’s Local Moran’s I</a></li>
  <li><a href="#getis-ord-gi-statistic" id="toc-getis-ord-gi-statistic" class="nav-link" data-scroll-target="#getis-ord-gi-statistic">Getis-Ord Gi Statistic</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#conclusion-2" id="toc-conclusion-2" class="nav-link" data-scroll-target="#conclusion-2">Conclusion</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Take Home Exercise 3</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Eugene Toh </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">October 28, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<p>The Philippines’ “War on Drugs,” initiated under President Rodrigo Duterte’s administration in 2016, represents one of the most controversial law enforcement campaigns in recent Southeast Asian history. This study employs advanced geospatial analytical techniques to examine the spatial and temporal distribution of drug-related killings across the Philippine archipelago from 2016 to 2024. Through Spatial Point Patterns Analysis and Spatio-Temporal Point Patterns Analysis, this research seeks to identify potential geographic clustering of incidents and evaluate the evolving pattern of cases across two presidential administrations. By analyzing the geographic distribution and temporal trends of these events, this study aims to provide empirical insights into both the implementation of the anti-drug campaign under both President Duterte’s and President Ferdinand Marcos Jr.’s administration, contributing to a data-driven understanding of this significant public policy issue.</p>
<section id="main-data-processing" class="level1">
<h1>Main data processing</h1>
<section id="import-dependencies" class="level2">
<h2 class="anchored" data-anchor-id="import-dependencies">Import dependencies</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(sf, tidyverse, tmap, spdep, knitr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="import-data" class="level2">
<h2 class="anchored" data-anchor-id="import-data">Import data</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>provinces_sf <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="st">"data"</span>, <span class="at">layer =</span> <span class="st">"phl_admbnda_adm2_psa_namria_20231106"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `phl_admbnda_adm2_psa_namria_20231106' from data source 
  `/home/tropicbliss/GitHub/quarto-project/Take-home_Ex/Take-home_Ex03/data' 
  using driver `ESRI Shapefile'
Simple feature collection with 88 features and 13 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 114.2779 ymin: 4.587294 xmax: 126.605 ymax: 21.12189
Geodetic CRS:  WGS 84</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>drugs_data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/2016-01-01-2024-06-30-Philippines.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 6921 Columns: 31
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (23): event_id_cnty, event_date, disorder_type, event_type, sub_event_ty...
dbl  (8): year, time_precision, iso, latitude, longitude, geo_precision, fat...

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">"plot"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>tmap mode set to plotting</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(provinces_sf) <span class="sc">+</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>() <span class="sc">+</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_text</span>(<span class="st">"ADM2_EN"</span>, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">remove.overlap =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="data-wrangling" class="level2">
<h2 class="anchored" data-anchor-id="data-wrangling">Data wrangling</h2>
<p>To combine the geographical spatial data with the aspatial drug cases data, we need to make sure that the province names in both data-frames are normalised.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>can_be_left_joined <span class="ot">&lt;-</span> <span class="fu">all</span>(provinces_sf<span class="sc">$</span>ADM2_EN <span class="sc">%in%</span> drugs_data<span class="sc">$</span>admin2)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>can_be_left_joined</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] FALSE</code></pre>
</div>
</div>
<p>It seems like not all province names in <code>drugs_data</code> is found in <code>provinces_sf</code>. This could be due to irregular naming conventions. Let’s see what are the discrepancies.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># values in provinces_sf not in drugs_data</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>non_matching_values <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(provinces_sf<span class="sc">$</span>ADM2_EN, drugs_data<span class="sc">$</span>admin2)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>non_matching_values</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "Batanes"                             "Aurora"                             
 [3] "Eastern Samar"                       "Samar (Western Samar)"              
 [5] "Biliran"                             "City of Isabela (not a province)"   
 [7] "Camiguin"                            "Davao de Oro (Compostela Valley)"   
 [9] "Cotabato (North Cotabato)"           "Metropolitan Manila First District" 
[11] "Metropolitan Manila Second District" "Metropolitan Manila Third District" 
[13] "Metropolitan Manila Fourth District" "Mountain Province"                  
[15] "Dinagat Islands"                     "Marinduque"                         
[17] "Romblon"                             "Special Geographic Area"            </code></pre>
</div>
</div>
<p>As we can see, we have 18 province names that are not found in <code>drugs_data</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>unique_values <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">unique</span>(drugs_data<span class="sc">$</span>admin2))</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>unique_values</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "Abra"                  "Agusan del Norte"      "Agusan del Sur"       
 [4] "Aklan"                 "Albay"                 "Antique"              
 [7] "Apayao"                "Basilan"               "Bataan"               
[10] "Batangas"              "Benguet"               "Bohol"                
[13] "Bukidnon"              "Bulacan"               "Cagayan"              
[16] "Camarines Norte"       "Camarines Sur"         "Capiz"                
[19] "Catanduanes"           "Cavite"                "Cebu"                 
[22] "Cotabato"              "Davao de Oro"          "Davao del Norte"      
[25] "Davao del Sur"         "Davao Occidental"      "Davao Oriental"       
[28] "Guimaras"              "Ifugao"                "Ilocos Norte"         
[31] "Ilocos Sur"            "Iloilo"                "Isabela"              
[34] "Kalinga"               "La Union"              "Laguna"               
[37] "Lanao del Norte"       "Lanao del Sur"         "Leyte"                
[40] "Maguindanao del Norte" "Maguindanao del Sur"   "Masbate"              
[43] "Metropolitan Manila"   "Misamis Occidental"    "Misamis Oriental"     
[46] "Negros Occidental"     "Negros Oriental"       "Northern Samar"       
[49] "Nueva Ecija"           "Nueva Vizcaya"         "Occidental Mindoro"   
[52] "Oriental Mindoro"      "Palawan"               "Pampanga"             
[55] "Pangasinan"            "Quezon"                "Quirino"              
[58] "Rizal"                 "Samar"                 "Sarangani"            
[61] "Siquijor"              "Sorsogon"              "South Cotabato"       
[64] "Southern Leyte"        "Sultan Kudarat"        "Sulu"                 
[67] "Surigao del Norte"     "Surigao del Sur"       "Tarlac"               
[70] "Tawi-Tawi"             "Zambales"              "Zamboanga del Norte"  
[73] "Zamboanga del Sur"     "Zamboanga Sibugay"    </code></pre>
</div>
</div>
<p>However, upon further analysis the names seem to all be in order, except the fact that the provinces of Aurora, Batanes, Biliran, Camiguin, Dinagat Islands, Eastern Samar, Ilocos Norte, Romblon are not mentioned in the drug data. It seems like no drug cases has ever been reported according to our data from the year 2016 to 2024.</p>
<p>Many of these areas (Batanes, Camiguin, Dinagat Islands, Romblon) are island provinces and Aurora and Eastern Samar are relatively remote. These areas have more dispersed populations and are less accessible, and hence limited infrastructure might affect both drug trafficking and reporting.</p>
<p>Let’s map it out to see what this is all about.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>not_in_data <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Aurora"</span>, <span class="st">"Batanes"</span>, <span class="st">"Biliran"</span>, <span class="st">"Camiguin"</span>, <span class="st">"Dinagat Islands"</span>, <span class="st">"Eastern Samar"</span>, <span class="st">"Mountain Province"</span>, <span class="st">"Romblon"</span>)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">"plot"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>tmap mode set to plotting</code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(provinces_sf) <span class="sc">+</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>() <span class="sc">+</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_shape</span>(provinces_sf <span class="sc">%&gt;%</span> <span class="fu">filter</span>(ADM2_EN <span class="sc">%in%</span> not_in_data)) <span class="sc">+</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>(<span class="at">col =</span> <span class="st">"red"</span>) <span class="sc">+</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_text</span>(<span class="st">"ADM2_EN"</span>, <span class="at">col =</span> <span class="st">"black"</span>, <span class="at">remove.overlap =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<p>Now, we need to rename the province names in both sets of data to make them consistent so joining can occur.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>drugs_data <span class="ot">&lt;-</span> drugs_data <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">admin2 =</span> <span class="fu">recode</span>(admin2, <span class="st">"Metropolitan Manila"</span> <span class="ot">=</span> <span class="st">"Metro Manila"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>province_names <span class="ot">&lt;-</span> <span class="fu">sort</span>(provinces_sf<span class="sc">$</span>ADM2_EN)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>province_names</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "Abra"                                "Agusan del Norte"                   
 [3] "Agusan del Sur"                      "Aklan"                              
 [5] "Albay"                               "Antique"                            
 [7] "Apayao"                              "Aurora"                             
 [9] "Basilan"                             "Bataan"                             
[11] "Batanes"                             "Batangas"                           
[13] "Benguet"                             "Biliran"                            
[15] "Bohol"                               "Bukidnon"                           
[17] "Bulacan"                             "Cagayan"                            
[19] "Camarines Norte"                     "Camarines Sur"                      
[21] "Camiguin"                            "Capiz"                              
[23] "Catanduanes"                         "Cavite"                             
[25] "Cebu"                                "City of Isabela (not a province)"   
[27] "Cotabato (North Cotabato)"           "Davao de Oro (Compostela Valley)"   
[29] "Davao del Norte"                     "Davao del Sur"                      
[31] "Davao Occidental"                    "Davao Oriental"                     
[33] "Dinagat Islands"                     "Eastern Samar"                      
[35] "Guimaras"                            "Ifugao"                             
[37] "Ilocos Norte"                        "Ilocos Sur"                         
[39] "Iloilo"                              "Isabela"                            
[41] "Kalinga"                             "La Union"                           
[43] "Laguna"                              "Lanao del Norte"                    
[45] "Lanao del Sur"                       "Leyte"                              
[47] "Maguindanao del Norte"               "Maguindanao del Sur"                
[49] "Marinduque"                          "Masbate"                            
[51] "Metropolitan Manila First District"  "Metropolitan Manila Fourth District"
[53] "Metropolitan Manila Second District" "Metropolitan Manila Third District" 
[55] "Misamis Occidental"                  "Misamis Oriental"                   
[57] "Mountain Province"                   "Negros Occidental"                  
[59] "Negros Oriental"                     "Northern Samar"                     
[61] "Nueva Ecija"                         "Nueva Vizcaya"                      
[63] "Occidental Mindoro"                  "Oriental Mindoro"                   
[65] "Palawan"                             "Pampanga"                           
[67] "Pangasinan"                          "Quezon"                             
[69] "Quirino"                             "Rizal"                              
[71] "Romblon"                             "Samar (Western Samar)"              
[73] "Sarangani"                           "Siquijor"                           
[75] "Sorsogon"                            "South Cotabato"                     
[77] "Southern Leyte"                      "Special Geographic Area"            
[79] "Sultan Kudarat"                      "Sulu"                               
[81] "Surigao del Norte"                   "Surigao del Sur"                    
[83] "Tarlac"                              "Tawi-Tawi"                          
[85] "Zambales"                            "Zamboanga del Norte"                
[87] "Zamboanga del Sur"                   "Zamboanga Sibugay"                  </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># </span><span class="al">NOTE</span><span class="co">: The City of Isabela is treated separately from Basilan province as it is a component city but belongs to a different region than its mother province, but we will merge both of them to make this simpler to understand</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>provinces_sf <span class="ot">&lt;-</span> provinces_sf <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">ADM2_EN =</span> <span class="fu">recode</span>(ADM2_EN, <span class="st">"City of Isabela (not a province)"</span> <span class="ot">=</span> <span class="st">"Basilan"</span>, <span class="st">"Cotabato (North Cotabato)"</span> <span class="ot">=</span> <span class="st">"Cotabato"</span>, <span class="st">"Davao de Oro (Compostela Valley)"</span> <span class="ot">=</span> <span class="st">"Davao de Oro"</span>, <span class="st">"Samar (Western Samar)"</span> <span class="ot">=</span> <span class="st">"Samar"</span>, <span class="st">"Metropolitan Manila First District"</span> <span class="ot">=</span> <span class="st">"Metro Manila"</span>, <span class="st">"Metropolitan Manila Second District"</span> <span class="ot">=</span> <span class="st">"Metro Manila"</span>, <span class="st">"Metropolitan Manila Third District"</span> <span class="ot">=</span> <span class="st">"Metro Manila"</span>, <span class="st">"Metropolitan Manila Fourth District"</span> <span class="ot">=</span> <span class="st">"Metro Manila"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now, I just need to make sure that there are no provinces that I missed.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>non_matching_values <span class="ot">&lt;-</span> <span class="fu">setdiff</span>(drugs_data<span class="sc">$</span>admin2, provinces_sf<span class="sc">$</span>ADM2_EN)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>non_matching_values</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>character(0)</code></pre>
</div>
</div>
<p>Nice!</p>
<p>Now, we simply need to merge the duplicate provinces together in <code>provinces_sf</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>provinces_sf <span class="ot">&lt;-</span> provinces_sf <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="dv">1</span>, <span class="dv">14</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>merged_provinces_sf <span class="ot">&lt;-</span> provinces_sf <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(ADM2_EN) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">geometry =</span> <span class="fu">st_union</span>(geometry))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">"plot"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>tmap mode set to plotting</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(merged_provinces_sf <span class="sc">%&gt;%</span> <span class="fu">filter</span>(ADM2_EN <span class="sc">==</span> <span class="st">"Metro Manila"</span>)) <span class="sc">+</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>() <span class="sc">+</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_text</span>(<span class="st">"ADM2_EN"</span>, <span class="at">col =</span> <span class="st">"blue"</span>, <span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">remove.overlap =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="are-the-number-of-cases-of-drug-related-incidents-in-philippines-affected-by-location-or-do-they-stay-the-same-no-matter-where-you-are-in-the-country" class="level1">
<h1>Are the number of cases of drug related incidents in Philippines affected by location, or do they stay the same no matter where you are in the country?</h1>
<p>Analyzing the spatial distribution of drug-related cases across the Philippines is crucial for understanding whether geographic location plays a significant role in their occurrence. This section employs global measures of spatial autocorrelation to systematically examine whether these cases exhibit spatial dependence or if they are randomly distributed across the country. Through the application of Moran’s I and Geary’s C statistics, we can quantitatively assess whether provinces with high numbers of cases tend to cluster together (positive spatial autocorrelation), if they are dispersed (negative spatial autocorrelation), or if the distribution shows no significant spatial pattern (spatial randomness). These global indicators provide a comprehensive first step in understanding the broad spatial patterns of drug-related cases, helping to determine whether the phenomenon is inherently geographic in nature or independent of location within the Philippine archipelago.</p>
<section id="data-wrangling-1" class="level2">
<h2 class="anchored" data-anchor-id="data-wrangling-1">Data wrangling</h2>
<p>We are going to analyse events by year, and analyse all types of events as a whole. That is, we are going to aggregate all types of events together and treat them all as drug related incidents. We are going to ignore the <code>fatalities</code> column in this case, as we personally find counting the number of events is more useful than counting the number of people affected in an event, especially since some events have essentially 0 fatalities, and hence that event would not be counted even if it is significant.</p>
<p>First, we select only the year and province name columns so we don’t get distracted by any of the event type columns. Then, we create a new column called <code>num_events</code> to summarise the number of events for each province for each year. <code>.groups = "drop"</code> is used to automatically ungroup. We then rename the province name column from <code>admin2</code> to <code>ADM2_EN</code> to ensure that <code>left_join</code> joins on the province name column.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>drug_data_agg <span class="ot">&lt;-</span> drugs_data <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="dv">3</span>, <span class="dv">20</span>) <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(year, admin2) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">num_events =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="at">ADM2_EN =</span> admin2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>province_drug_stats <span class="ot">&lt;-</span> <span class="fu">left_join</span>(merged_provinces_sf, drug_data_agg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Joining with `by = join_by(ADM2_EN)`</code></pre>
</div>
</div>
<p>This duplicates the same polygons for each year, so it might not be the most memory efficient operation, but it is definitely the easiest to reason about later.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>province_drug_stats <span class="sc">%&gt;%</span> <span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<colgroup>
<col style="width: 33%">
<col style="width: 43%">
<col style="width: 7%">
<col style="width: 15%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">ADM2_EN</th>
<th style="text-align: left;">geometry</th>
<th style="text-align: right;">year</th>
<th style="text-align: right;">num_events</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Abra</td>
<td style="text-align: left;">POLYGON ((121.1088 17.73945…</td>
<td style="text-align: right;">2016</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="even">
<td style="text-align: left;">Abra</td>
<td style="text-align: left;">POLYGON ((121.1088 17.73945…</td>
<td style="text-align: right;">2017</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Abra</td>
<td style="text-align: left;">POLYGON ((121.1088 17.73945…</td>
<td style="text-align: right;">2019</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Abra</td>
<td style="text-align: left;">POLYGON ((121.1088 17.73945…</td>
<td style="text-align: right;">2020</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Abra</td>
<td style="text-align: left;">POLYGON ((121.1088 17.73945…</td>
<td style="text-align: right;">2024</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">Agusan del Norte</td>
<td style="text-align: left;">MULTIPOLYGON (((125.5546 9….</td>
<td style="text-align: right;">2016</td>
<td style="text-align: right;">17</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Agusan del Norte</td>
<td style="text-align: left;">MULTIPOLYGON (((125.5546 9….</td>
<td style="text-align: right;">2017</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Agusan del Norte</td>
<td style="text-align: left;">MULTIPOLYGON (((125.5546 9….</td>
<td style="text-align: right;">2021</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Agusan del Norte</td>
<td style="text-align: left;">MULTIPOLYGON (((125.5546 9….</td>
<td style="text-align: right;">2022</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">Agusan del Norte</td>
<td style="text-align: left;">MULTIPOLYGON (((125.5546 9….</td>
<td style="text-align: right;">2024</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Agusan del Sur</td>
<td style="text-align: left;">POLYGON ((126.2278 8.000244…</td>
<td style="text-align: right;">2016</td>
<td style="text-align: right;">12</td>
</tr>
<tr class="even">
<td style="text-align: left;">Agusan del Sur</td>
<td style="text-align: left;">POLYGON ((126.2278 8.000244…</td>
<td style="text-align: right;">2017</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Agusan del Sur</td>
<td style="text-align: left;">POLYGON ((126.2278 8.000244…</td>
<td style="text-align: right;">2019</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Agusan del Sur</td>
<td style="text-align: left;">POLYGON ((126.2278 8.000244…</td>
<td style="text-align: right;">2020</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Aklan</td>
<td style="text-align: left;">MULTIPOLYGON (((121.9216 11…</td>
<td style="text-align: right;">2016</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">Aklan</td>
<td style="text-align: left;">MULTIPOLYGON (((121.9216 11…</td>
<td style="text-align: right;">2017</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Albay</td>
<td style="text-align: left;">MULTIPOLYGON (((123.6012 13…</td>
<td style="text-align: right;">2016</td>
<td style="text-align: right;">27</td>
</tr>
<tr class="even">
<td style="text-align: left;">Albay</td>
<td style="text-align: left;">MULTIPOLYGON (((123.6012 13…</td>
<td style="text-align: right;">2017</td>
<td style="text-align: right;">17</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Albay</td>
<td style="text-align: left;">MULTIPOLYGON (((123.6012 13…</td>
<td style="text-align: right;">2018</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="even">
<td style="text-align: left;">Albay</td>
<td style="text-align: left;">MULTIPOLYGON (((123.6012 13…</td>
<td style="text-align: right;">2019</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Albay</td>
<td style="text-align: left;">MULTIPOLYGON (((123.6012 13…</td>
<td style="text-align: right;">2020</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="even">
<td style="text-align: left;">Albay</td>
<td style="text-align: left;">MULTIPOLYGON (((123.6012 13…</td>
<td style="text-align: right;">2021</td>
<td style="text-align: right;">9</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Antique</td>
<td style="text-align: left;">MULTIPOLYGON (((121.4341 12…</td>
<td style="text-align: right;">2016</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Antique</td>
<td style="text-align: left;">MULTIPOLYGON (((121.4341 12…</td>
<td style="text-align: right;">2017</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Antique</td>
<td style="text-align: left;">MULTIPOLYGON (((121.4341 12…</td>
<td style="text-align: right;">2018</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: left;">Apayao</td>
<td style="text-align: left;">POLYGON ((121.4351 17.697, …</td>
<td style="text-align: right;">2016</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Apayao</td>
<td style="text-align: left;">POLYGON ((121.4351 17.697, …</td>
<td style="text-align: right;">2017</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Aurora</td>
<td style="text-align: left;">MULTIPOLYGON (((122.2337 16…</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Basilan</td>
<td style="text-align: left;">MULTIPOLYGON (((121.9913 6….</td>
<td style="text-align: right;">2016</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: left;">Basilan</td>
<td style="text-align: left;">MULTIPOLYGON (((121.9913 6….</td>
<td style="text-align: right;">2017</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Basilan</td>
<td style="text-align: left;">MULTIPOLYGON (((121.9913 6….</td>
<td style="text-align: right;">2018</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Basilan</td>
<td style="text-align: left;">MULTIPOLYGON (((121.9913 6….</td>
<td style="text-align: right;">2021</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Basilan</td>
<td style="text-align: left;">MULTIPOLYGON (((121.9913 6….</td>
<td style="text-align: right;">2022</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">Basilan</td>
<td style="text-align: left;">MULTIPOLYGON (((121.9913 6….</td>
<td style="text-align: right;">2023</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Basilan</td>
<td style="text-align: left;">MULTIPOLYGON (((121.9913 6….</td>
<td style="text-align: right;">2024</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Bataan</td>
<td style="text-align: left;">POLYGON ((120.5541 14.82082…</td>
<td style="text-align: right;">2016</td>
<td style="text-align: right;">22</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Bataan</td>
<td style="text-align: left;">POLYGON ((120.5541 14.82082…</td>
<td style="text-align: right;">2017</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="even">
<td style="text-align: left;">Bataan</td>
<td style="text-align: left;">POLYGON ((120.5541 14.82082…</td>
<td style="text-align: right;">2018</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Bataan</td>
<td style="text-align: left;">POLYGON ((120.5541 14.82082…</td>
<td style="text-align: right;">2019</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">Bataan</td>
<td style="text-align: left;">POLYGON ((120.5541 14.82082…</td>
<td style="text-align: right;">2021</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Bataan</td>
<td style="text-align: left;">POLYGON ((120.5541 14.82082…</td>
<td style="text-align: right;">2022</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Bataan</td>
<td style="text-align: left;">POLYGON ((120.5541 14.82082…</td>
<td style="text-align: right;">2023</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Batanes</td>
<td style="text-align: left;">MULTIPOLYGON (((121.9489 21…</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">Batangas</td>
<td style="text-align: left;">MULTIPOLYGON (((121.0889 13…</td>
<td style="text-align: right;">2016</td>
<td style="text-align: right;">50</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Batangas</td>
<td style="text-align: left;">MULTIPOLYGON (((121.0889 13…</td>
<td style="text-align: right;">2017</td>
<td style="text-align: right;">38</td>
</tr>
<tr class="even">
<td style="text-align: left;">Batangas</td>
<td style="text-align: left;">MULTIPOLYGON (((121.0889 13…</td>
<td style="text-align: right;">2018</td>
<td style="text-align: right;">32</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Batangas</td>
<td style="text-align: left;">MULTIPOLYGON (((121.0889 13…</td>
<td style="text-align: right;">2019</td>
<td style="text-align: right;">17</td>
</tr>
<tr class="even">
<td style="text-align: left;">Batangas</td>
<td style="text-align: left;">MULTIPOLYGON (((121.0889 13…</td>
<td style="text-align: right;">2020</td>
<td style="text-align: right;">13</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Batangas</td>
<td style="text-align: left;">MULTIPOLYGON (((121.0889 13…</td>
<td style="text-align: right;">2021</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="even">
<td style="text-align: left;">Batangas</td>
<td style="text-align: left;">MULTIPOLYGON (((121.0889 13…</td>
<td style="text-align: right;">2022</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Batangas</td>
<td style="text-align: left;">MULTIPOLYGON (((121.0889 13…</td>
<td style="text-align: right;">2023</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: left;">Batangas</td>
<td style="text-align: left;">MULTIPOLYGON (((121.0889 13…</td>
<td style="text-align: right;">2024</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Benguet</td>
<td style="text-align: left;">POLYGON ((120.7706 16.92119…</td>
<td style="text-align: right;">2016</td>
<td style="text-align: right;">31</td>
</tr>
<tr class="even">
<td style="text-align: left;">Benguet</td>
<td style="text-align: left;">POLYGON ((120.7706 16.92119…</td>
<td style="text-align: right;">2017</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Benguet</td>
<td style="text-align: left;">POLYGON ((120.7706 16.92119…</td>
<td style="text-align: right;">2018</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="even">
<td style="text-align: left;">Benguet</td>
<td style="text-align: left;">POLYGON ((120.7706 16.92119…</td>
<td style="text-align: right;">2019</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Benguet</td>
<td style="text-align: left;">POLYGON ((120.7706 16.92119…</td>
<td style="text-align: right;">2020</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">Benguet</td>
<td style="text-align: left;">POLYGON ((120.7706 16.92119…</td>
<td style="text-align: right;">2022</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Biliran</td>
<td style="text-align: left;">MULTIPOLYGON (((124.3248 11…</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">Bohol</td>
<td style="text-align: left;">MULTIPOLYGON (((123.9225 9….</td>
<td style="text-align: right;">2016</td>
<td style="text-align: right;">21</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Bohol</td>
<td style="text-align: left;">MULTIPOLYGON (((123.9225 9….</td>
<td style="text-align: right;">2017</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: left;">Bohol</td>
<td style="text-align: left;">MULTIPOLYGON (((123.9225 9….</td>
<td style="text-align: right;">2018</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Bohol</td>
<td style="text-align: left;">MULTIPOLYGON (((123.9225 9….</td>
<td style="text-align: right;">2019</td>
<td style="text-align: right;">15</td>
</tr>
<tr class="even">
<td style="text-align: left;">Bohol</td>
<td style="text-align: left;">MULTIPOLYGON (((123.9225 9….</td>
<td style="text-align: right;">2020</td>
<td style="text-align: right;">9</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Bohol</td>
<td style="text-align: left;">MULTIPOLYGON (((123.9225 9….</td>
<td style="text-align: right;">2021</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: left;">Bohol</td>
<td style="text-align: left;">MULTIPOLYGON (((123.9225 9….</td>
<td style="text-align: right;">2022</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Bohol</td>
<td style="text-align: left;">MULTIPOLYGON (((123.9225 9….</td>
<td style="text-align: right;">2023</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">Bukidnon</td>
<td style="text-align: left;">POLYGON ((125.092 8.583275,…</td>
<td style="text-align: right;">2019</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Bukidnon</td>
<td style="text-align: left;">POLYGON ((125.092 8.583275,…</td>
<td style="text-align: right;">2020</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: left;">Bukidnon</td>
<td style="text-align: left;">POLYGON ((125.092 8.583275,…</td>
<td style="text-align: right;">2021</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Bukidnon</td>
<td style="text-align: left;">POLYGON ((125.092 8.583275,…</td>
<td style="text-align: right;">2022</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Bulacan</td>
<td style="text-align: left;">POLYGON ((121.145 15.2722, …</td>
<td style="text-align: right;">2016</td>
<td style="text-align: right;">261</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Bulacan</td>
<td style="text-align: left;">POLYGON ((121.145 15.2722, …</td>
<td style="text-align: right;">2017</td>
<td style="text-align: right;">270</td>
</tr>
<tr class="even">
<td style="text-align: left;">Bulacan</td>
<td style="text-align: left;">POLYGON ((121.145 15.2722, …</td>
<td style="text-align: right;">2018</td>
<td style="text-align: right;">155</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Bulacan</td>
<td style="text-align: left;">POLYGON ((121.145 15.2722, …</td>
<td style="text-align: right;">2019</td>
<td style="text-align: right;">91</td>
</tr>
<tr class="even">
<td style="text-align: left;">Bulacan</td>
<td style="text-align: left;">POLYGON ((121.145 15.2722, …</td>
<td style="text-align: right;">2020</td>
<td style="text-align: right;">59</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Bulacan</td>
<td style="text-align: left;">POLYGON ((121.145 15.2722, …</td>
<td style="text-align: right;">2021</td>
<td style="text-align: right;">35</td>
</tr>
<tr class="even">
<td style="text-align: left;">Bulacan</td>
<td style="text-align: left;">POLYGON ((121.145 15.2722, …</td>
<td style="text-align: right;">2022</td>
<td style="text-align: right;">11</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Bulacan</td>
<td style="text-align: left;">POLYGON ((121.145 15.2722, …</td>
<td style="text-align: right;">2024</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cagayan</td>
<td style="text-align: left;">MULTIPOLYGON (((121.9597 19…</td>
<td style="text-align: right;">2016</td>
<td style="text-align: right;">22</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cagayan</td>
<td style="text-align: left;">MULTIPOLYGON (((121.9597 19…</td>
<td style="text-align: right;">2017</td>
<td style="text-align: right;">50</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cagayan</td>
<td style="text-align: left;">MULTIPOLYGON (((121.9597 19…</td>
<td style="text-align: right;">2018</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cagayan</td>
<td style="text-align: left;">MULTIPOLYGON (((121.9597 19…</td>
<td style="text-align: right;">2019</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cagayan</td>
<td style="text-align: left;">MULTIPOLYGON (((121.9597 19…</td>
<td style="text-align: right;">2020</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cagayan</td>
<td style="text-align: left;">MULTIPOLYGON (((121.9597 19…</td>
<td style="text-align: right;">2021</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Camarines Norte</td>
<td style="text-align: left;">MULTIPOLYGON (((122.929 14….</td>
<td style="text-align: right;">2016</td>
<td style="text-align: right;">28</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Camarines Norte</td>
<td style="text-align: left;">MULTIPOLYGON (((122.929 14….</td>
<td style="text-align: right;">2017</td>
<td style="text-align: right;">10</td>
</tr>
<tr class="even">
<td style="text-align: left;">Camarines Norte</td>
<td style="text-align: left;">MULTIPOLYGON (((122.929 14….</td>
<td style="text-align: right;">2019</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Camarines Norte</td>
<td style="text-align: left;">MULTIPOLYGON (((122.929 14….</td>
<td style="text-align: right;">2020</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="even">
<td style="text-align: left;">Camarines Norte</td>
<td style="text-align: left;">MULTIPOLYGON (((122.929 14….</td>
<td style="text-align: right;">2021</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Camarines Norte</td>
<td style="text-align: left;">MULTIPOLYGON (((122.929 14….</td>
<td style="text-align: right;">2022</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Camarines Norte</td>
<td style="text-align: left;">MULTIPOLYGON (((122.929 14….</td>
<td style="text-align: right;">2023</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Camarines Sur</td>
<td style="text-align: left;">MULTIPOLYGON (((123.5704 13…</td>
<td style="text-align: right;">2016</td>
<td style="text-align: right;">25</td>
</tr>
<tr class="even">
<td style="text-align: left;">Camarines Sur</td>
<td style="text-align: left;">MULTIPOLYGON (((123.5704 13…</td>
<td style="text-align: right;">2017</td>
<td style="text-align: right;">9</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Camarines Sur</td>
<td style="text-align: left;">MULTIPOLYGON (((123.5704 13…</td>
<td style="text-align: right;">2018</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="even">
<td style="text-align: left;">Camarines Sur</td>
<td style="text-align: left;">MULTIPOLYGON (((123.5704 13…</td>
<td style="text-align: right;">2019</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Camarines Sur</td>
<td style="text-align: left;">MULTIPOLYGON (((123.5704 13…</td>
<td style="text-align: right;">2020</td>
<td style="text-align: right;">21</td>
</tr>
<tr class="even">
<td style="text-align: left;">Camarines Sur</td>
<td style="text-align: left;">MULTIPOLYGON (((123.5704 13…</td>
<td style="text-align: right;">2021</td>
<td style="text-align: right;">19</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Camarines Sur</td>
<td style="text-align: left;">MULTIPOLYGON (((123.5704 13…</td>
<td style="text-align: right;">2022</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: left;">Camarines Sur</td>
<td style="text-align: left;">MULTIPOLYGON (((123.5704 13…</td>
<td style="text-align: right;">2023</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Camiguin</td>
<td style="text-align: left;">MULTIPOLYGON (((124.6987 9….</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">Capiz</td>
<td style="text-align: left;">MULTIPOLYGON (((122.841 11….</td>
<td style="text-align: right;">2016</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Capiz</td>
<td style="text-align: left;">MULTIPOLYGON (((122.841 11….</td>
<td style="text-align: right;">2017</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Capiz</td>
<td style="text-align: left;">MULTIPOLYGON (((122.841 11….</td>
<td style="text-align: right;">2018</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Capiz</td>
<td style="text-align: left;">MULTIPOLYGON (((122.841 11….</td>
<td style="text-align: right;">2020</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Capiz</td>
<td style="text-align: left;">MULTIPOLYGON (((122.841 11….</td>
<td style="text-align: right;">2021</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Catanduanes</td>
<td style="text-align: left;">MULTIPOLYGON (((124.2062 14…</td>
<td style="text-align: right;">2016</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">Catanduanes</td>
<td style="text-align: left;">MULTIPOLYGON (((124.2062 14…</td>
<td style="text-align: right;">2020</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cavite</td>
<td style="text-align: left;">MULTIPOLYGON (((120.9699 14…</td>
<td style="text-align: right;">2016</td>
<td style="text-align: right;">60</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cavite</td>
<td style="text-align: left;">MULTIPOLYGON (((120.9699 14…</td>
<td style="text-align: right;">2017</td>
<td style="text-align: right;">45</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cavite</td>
<td style="text-align: left;">MULTIPOLYGON (((120.9699 14…</td>
<td style="text-align: right;">2018</td>
<td style="text-align: right;">70</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cavite</td>
<td style="text-align: left;">MULTIPOLYGON (((120.9699 14…</td>
<td style="text-align: right;">2019</td>
<td style="text-align: right;">21</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cavite</td>
<td style="text-align: left;">MULTIPOLYGON (((120.9699 14…</td>
<td style="text-align: right;">2020</td>
<td style="text-align: right;">34</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cavite</td>
<td style="text-align: left;">MULTIPOLYGON (((120.9699 14…</td>
<td style="text-align: right;">2021</td>
<td style="text-align: right;">49</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cavite</td>
<td style="text-align: left;">MULTIPOLYGON (((120.9699 14…</td>
<td style="text-align: right;">2022</td>
<td style="text-align: right;">10</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cavite</td>
<td style="text-align: left;">MULTIPOLYGON (((120.9699 14…</td>
<td style="text-align: right;">2023</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cavite</td>
<td style="text-align: left;">MULTIPOLYGON (((120.9699 14…</td>
<td style="text-align: right;">2024</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cebu</td>
<td style="text-align: left;">MULTIPOLYGON (((124.0931 11…</td>
<td style="text-align: right;">2016</td>
<td style="text-align: right;">199</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cebu</td>
<td style="text-align: left;">MULTIPOLYGON (((124.0931 11…</td>
<td style="text-align: right;">2017</td>
<td style="text-align: right;">87</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cebu</td>
<td style="text-align: left;">MULTIPOLYGON (((124.0931 11…</td>
<td style="text-align: right;">2018</td>
<td style="text-align: right;">69</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cebu</td>
<td style="text-align: left;">MULTIPOLYGON (((124.0931 11…</td>
<td style="text-align: right;">2019</td>
<td style="text-align: right;">59</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cebu</td>
<td style="text-align: left;">MULTIPOLYGON (((124.0931 11…</td>
<td style="text-align: right;">2020</td>
<td style="text-align: right;">54</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cebu</td>
<td style="text-align: left;">MULTIPOLYGON (((124.0931 11…</td>
<td style="text-align: right;">2021</td>
<td style="text-align: right;">33</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cebu</td>
<td style="text-align: left;">MULTIPOLYGON (((124.0931 11…</td>
<td style="text-align: right;">2022</td>
<td style="text-align: right;">64</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cebu</td>
<td style="text-align: left;">MULTIPOLYGON (((124.0931 11…</td>
<td style="text-align: right;">2023</td>
<td style="text-align: right;">45</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cebu</td>
<td style="text-align: left;">MULTIPOLYGON (((124.0931 11…</td>
<td style="text-align: right;">2024</td>
<td style="text-align: right;">19</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cotabato</td>
<td style="text-align: left;">MULTIPOLYGON (((124.7988 7….</td>
<td style="text-align: right;">2016</td>
<td style="text-align: right;">16</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cotabato</td>
<td style="text-align: left;">MULTIPOLYGON (((124.7988 7….</td>
<td style="text-align: right;">2017</td>
<td style="text-align: right;">11</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cotabato</td>
<td style="text-align: left;">MULTIPOLYGON (((124.7988 7….</td>
<td style="text-align: right;">2018</td>
<td style="text-align: right;">18</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cotabato</td>
<td style="text-align: left;">MULTIPOLYGON (((124.7988 7….</td>
<td style="text-align: right;">2019</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cotabato</td>
<td style="text-align: left;">MULTIPOLYGON (((124.7988 7….</td>
<td style="text-align: right;">2020</td>
<td style="text-align: right;">11</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cotabato</td>
<td style="text-align: left;">MULTIPOLYGON (((124.7988 7….</td>
<td style="text-align: right;">2021</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cotabato</td>
<td style="text-align: left;">MULTIPOLYGON (((124.7988 7….</td>
<td style="text-align: right;">2022</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cotabato</td>
<td style="text-align: left;">MULTIPOLYGON (((124.7988 7….</td>
<td style="text-align: right;">2023</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cotabato</td>
<td style="text-align: left;">MULTIPOLYGON (((124.7988 7….</td>
<td style="text-align: right;">2024</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Davao Occidental</td>
<td style="text-align: left;">MULTIPOLYGON (((125.3171 5….</td>
<td style="text-align: right;">2021</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Davao Oriental</td>
<td style="text-align: left;">MULTIPOLYGON (((126.3683 7….</td>
<td style="text-align: right;">2016</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">Davao Oriental</td>
<td style="text-align: left;">MULTIPOLYGON (((126.3683 7….</td>
<td style="text-align: right;">2017</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Davao Oriental</td>
<td style="text-align: left;">MULTIPOLYGON (((126.3683 7….</td>
<td style="text-align: right;">2018</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">Davao de Oro</td>
<td style="text-align: left;">MULTIPOLYGON (((126.1577 7….</td>
<td style="text-align: right;">2016</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Davao de Oro</td>
<td style="text-align: left;">MULTIPOLYGON (((126.1577 7….</td>
<td style="text-align: right;">2017</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: left;">Davao de Oro</td>
<td style="text-align: left;">MULTIPOLYGON (((126.1577 7….</td>
<td style="text-align: right;">2021</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Davao del Norte</td>
<td style="text-align: left;">MULTIPOLYGON (((125.3794 8….</td>
<td style="text-align: right;">2016</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: left;">Davao del Norte</td>
<td style="text-align: left;">MULTIPOLYGON (((125.3794 8….</td>
<td style="text-align: right;">2017</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Davao del Norte</td>
<td style="text-align: left;">MULTIPOLYGON (((125.3794 8….</td>
<td style="text-align: right;">2018</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: left;">Davao del Norte</td>
<td style="text-align: left;">MULTIPOLYGON (((125.3794 8….</td>
<td style="text-align: right;">2019</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Davao del Norte</td>
<td style="text-align: left;">MULTIPOLYGON (((125.3794 8….</td>
<td style="text-align: right;">2021</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Davao del Sur</td>
<td style="text-align: left;">POLYGON ((125.68 7.261004, …</td>
<td style="text-align: right;">2016</td>
<td style="text-align: right;">14</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Davao del Sur</td>
<td style="text-align: left;">POLYGON ((125.68 7.261004, …</td>
<td style="text-align: right;">2017</td>
<td style="text-align: right;">9</td>
</tr>
<tr class="even">
<td style="text-align: left;">Davao del Sur</td>
<td style="text-align: left;">POLYGON ((125.68 7.261004, …</td>
<td style="text-align: right;">2018</td>
<td style="text-align: right;">18</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Davao del Sur</td>
<td style="text-align: left;">POLYGON ((125.68 7.261004, …</td>
<td style="text-align: right;">2019</td>
<td style="text-align: right;">11</td>
</tr>
<tr class="even">
<td style="text-align: left;">Davao del Sur</td>
<td style="text-align: left;">POLYGON ((125.68 7.261004, …</td>
<td style="text-align: right;">2020</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Davao del Sur</td>
<td style="text-align: left;">POLYGON ((125.68 7.261004, …</td>
<td style="text-align: right;">2021</td>
<td style="text-align: right;">15</td>
</tr>
<tr class="even">
<td style="text-align: left;">Davao del Sur</td>
<td style="text-align: left;">POLYGON ((125.68 7.261004, …</td>
<td style="text-align: right;">2022</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Davao del Sur</td>
<td style="text-align: left;">POLYGON ((125.68 7.261004, …</td>
<td style="text-align: right;">2023</td>
<td style="text-align: right;">23</td>
</tr>
<tr class="even">
<td style="text-align: left;">Davao del Sur</td>
<td style="text-align: left;">POLYGON ((125.68 7.261004, …</td>
<td style="text-align: right;">2024</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Dinagat Islands</td>
<td style="text-align: left;">MULTIPOLYGON (((125.499 10….</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">Eastern Samar</td>
<td style="text-align: left;">MULTIPOLYGON (((125.3229 12…</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Guimaras</td>
<td style="text-align: left;">MULTIPOLYGON (((122.4859 10…</td>
<td style="text-align: right;">2016</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Guimaras</td>
<td style="text-align: left;">MULTIPOLYGON (((122.4859 10…</td>
<td style="text-align: right;">2018</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Ifugao</td>
<td style="text-align: left;">POLYGON ((121.5513 17.07884…</td>
<td style="text-align: right;">2016</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Ilocos Norte</td>
<td style="text-align: left;">POLYGON ((120.9714 18.57995…</td>
<td style="text-align: right;">2016</td>
<td style="text-align: right;">14</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Ilocos Norte</td>
<td style="text-align: left;">POLYGON ((120.9714 18.57995…</td>
<td style="text-align: right;">2017</td>
<td style="text-align: right;">11</td>
</tr>
<tr class="even">
<td style="text-align: left;">Ilocos Norte</td>
<td style="text-align: left;">POLYGON ((120.9714 18.57995…</td>
<td style="text-align: right;">2018</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Ilocos Norte</td>
<td style="text-align: left;">POLYGON ((120.9714 18.57995…</td>
<td style="text-align: right;">2019</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Ilocos Norte</td>
<td style="text-align: left;">POLYGON ((120.9714 18.57995…</td>
<td style="text-align: right;">2020</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Ilocos Norte</td>
<td style="text-align: left;">POLYGON ((120.9714 18.57995…</td>
<td style="text-align: right;">2021</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Ilocos Sur</td>
<td style="text-align: left;">MULTIPOLYGON (((120.5406 17…</td>
<td style="text-align: right;">2016</td>
<td style="text-align: right;">43</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Ilocos Sur</td>
<td style="text-align: left;">MULTIPOLYGON (((120.5406 17…</td>
<td style="text-align: right;">2017</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="even">
<td style="text-align: left;">Ilocos Sur</td>
<td style="text-align: left;">MULTIPOLYGON (((120.5406 17…</td>
<td style="text-align: right;">2018</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Ilocos Sur</td>
<td style="text-align: left;">MULTIPOLYGON (((120.5406 17…</td>
<td style="text-align: right;">2019</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Ilocos Sur</td>
<td style="text-align: left;">MULTIPOLYGON (((120.5406 17…</td>
<td style="text-align: right;">2020</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Ilocos Sur</td>
<td style="text-align: left;">MULTIPOLYGON (((120.5406 17…</td>
<td style="text-align: right;">2021</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Ilocos Sur</td>
<td style="text-align: left;">MULTIPOLYGON (((120.5406 17…</td>
<td style="text-align: right;">2024</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Iloilo</td>
<td style="text-align: left;">MULTIPOLYGON (((123.3489 11…</td>
<td style="text-align: right;">2016</td>
<td style="text-align: right;">19</td>
</tr>
<tr class="even">
<td style="text-align: left;">Iloilo</td>
<td style="text-align: left;">MULTIPOLYGON (((123.3489 11…</td>
<td style="text-align: right;">2017</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Iloilo</td>
<td style="text-align: left;">MULTIPOLYGON (((123.3489 11…</td>
<td style="text-align: right;">2018</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="even">
<td style="text-align: left;">Iloilo</td>
<td style="text-align: left;">MULTIPOLYGON (((123.3489 11…</td>
<td style="text-align: right;">2019</td>
<td style="text-align: right;">10</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Iloilo</td>
<td style="text-align: left;">MULTIPOLYGON (((123.3489 11…</td>
<td style="text-align: right;">2020</td>
<td style="text-align: right;">9</td>
</tr>
<tr class="even">
<td style="text-align: left;">Iloilo</td>
<td style="text-align: left;">MULTIPOLYGON (((123.3489 11…</td>
<td style="text-align: right;">2021</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Iloilo</td>
<td style="text-align: left;">MULTIPOLYGON (((123.3489 11…</td>
<td style="text-align: right;">2022</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: left;">Iloilo</td>
<td style="text-align: left;">MULTIPOLYGON (((123.3489 11…</td>
<td style="text-align: right;">2023</td>
<td style="text-align: right;">10</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Iloilo</td>
<td style="text-align: left;">MULTIPOLYGON (((123.3489 11…</td>
<td style="text-align: right;">2024</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">Isabela</td>
<td style="text-align: left;">MULTIPOLYGON (((122.1706 17…</td>
<td style="text-align: right;">2016</td>
<td style="text-align: right;">31</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Isabela</td>
<td style="text-align: left;">MULTIPOLYGON (((122.1706 17…</td>
<td style="text-align: right;">2017</td>
<td style="text-align: right;">76</td>
</tr>
<tr class="even">
<td style="text-align: left;">Isabela</td>
<td style="text-align: left;">MULTIPOLYGON (((122.1706 17…</td>
<td style="text-align: right;">2018</td>
<td style="text-align: right;">10</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Isabela</td>
<td style="text-align: left;">MULTIPOLYGON (((122.1706 17…</td>
<td style="text-align: right;">2019</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: left;">Isabela</td>
<td style="text-align: left;">MULTIPOLYGON (((122.1706 17…</td>
<td style="text-align: right;">2020</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Kalinga</td>
<td style="text-align: left;">POLYGON ((121.6396 17.50436…</td>
<td style="text-align: right;">2016</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">Kalinga</td>
<td style="text-align: left;">POLYGON ((121.6396 17.50436…</td>
<td style="text-align: right;">2021</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Kalinga</td>
<td style="text-align: left;">POLYGON ((121.6396 17.50436…</td>
<td style="text-align: right;">2022</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">La Union</td>
<td style="text-align: left;">POLYGON ((120.5645 16.67007…</td>
<td style="text-align: right;">2016</td>
<td style="text-align: right;">30</td>
</tr>
<tr class="odd">
<td style="text-align: left;">La Union</td>
<td style="text-align: left;">POLYGON ((120.5645 16.67007…</td>
<td style="text-align: right;">2017</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: left;">La Union</td>
<td style="text-align: left;">POLYGON ((120.5645 16.67007…</td>
<td style="text-align: right;">2018</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="odd">
<td style="text-align: left;">La Union</td>
<td style="text-align: left;">POLYGON ((120.5645 16.67007…</td>
<td style="text-align: right;">2019</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">La Union</td>
<td style="text-align: left;">POLYGON ((120.5645 16.67007…</td>
<td style="text-align: right;">2020</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Laguna</td>
<td style="text-align: left;">MULTIPOLYGON (((121.2067 14…</td>
<td style="text-align: right;">2016</td>
<td style="text-align: right;">74</td>
</tr>
<tr class="even">
<td style="text-align: left;">Laguna</td>
<td style="text-align: left;">MULTIPOLYGON (((121.2067 14…</td>
<td style="text-align: right;">2017</td>
<td style="text-align: right;">43</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Laguna</td>
<td style="text-align: left;">MULTIPOLYGON (((121.2067 14…</td>
<td style="text-align: right;">2018</td>
<td style="text-align: right;">82</td>
</tr>
<tr class="even">
<td style="text-align: left;">Laguna</td>
<td style="text-align: left;">MULTIPOLYGON (((121.2067 14…</td>
<td style="text-align: right;">2019</td>
<td style="text-align: right;">69</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Laguna</td>
<td style="text-align: left;">MULTIPOLYGON (((121.2067 14…</td>
<td style="text-align: right;">2020</td>
<td style="text-align: right;">27</td>
</tr>
<tr class="even">
<td style="text-align: left;">Laguna</td>
<td style="text-align: left;">MULTIPOLYGON (((121.2067 14…</td>
<td style="text-align: right;">2021</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Laguna</td>
<td style="text-align: left;">MULTIPOLYGON (((121.2067 14…</td>
<td style="text-align: right;">2022</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="even">
<td style="text-align: left;">Laguna</td>
<td style="text-align: left;">MULTIPOLYGON (((121.2067 14…</td>
<td style="text-align: right;">2023</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Laguna</td>
<td style="text-align: left;">MULTIPOLYGON (((121.2067 14…</td>
<td style="text-align: right;">2024</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">Lanao del Norte</td>
<td style="text-align: left;">POLYGON ((124.2482 8.33171,…</td>
<td style="text-align: right;">2016</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Lanao del Norte</td>
<td style="text-align: left;">POLYGON ((124.2482 8.33171,…</td>
<td style="text-align: right;">2017</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: left;">Lanao del Norte</td>
<td style="text-align: left;">POLYGON ((124.2482 8.33171,…</td>
<td style="text-align: right;">2018</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Lanao del Norte</td>
<td style="text-align: left;">POLYGON ((124.2482 8.33171,…</td>
<td style="text-align: right;">2019</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: left;">Lanao del Norte</td>
<td style="text-align: left;">POLYGON ((124.2482 8.33171,…</td>
<td style="text-align: right;">2020</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Lanao del Norte</td>
<td style="text-align: left;">POLYGON ((124.2482 8.33171,…</td>
<td style="text-align: right;">2023</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Lanao del Sur</td>
<td style="text-align: left;">POLYGON ((124.484 8.158501,…</td>
<td style="text-align: right;">2016</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Lanao del Sur</td>
<td style="text-align: left;">POLYGON ((124.484 8.158501,…</td>
<td style="text-align: right;">2017</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: left;">Lanao del Sur</td>
<td style="text-align: left;">POLYGON ((124.484 8.158501,…</td>
<td style="text-align: right;">2018</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Lanao del Sur</td>
<td style="text-align: left;">POLYGON ((124.484 8.158501,…</td>
<td style="text-align: right;">2019</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: left;">Lanao del Sur</td>
<td style="text-align: left;">POLYGON ((124.484 8.158501,…</td>
<td style="text-align: right;">2020</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Lanao del Sur</td>
<td style="text-align: left;">POLYGON ((124.484 8.158501,…</td>
<td style="text-align: right;">2021</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: left;">Lanao del Sur</td>
<td style="text-align: left;">POLYGON ((124.484 8.158501,…</td>
<td style="text-align: right;">2022</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Lanao del Sur</td>
<td style="text-align: left;">POLYGON ((124.484 8.158501,…</td>
<td style="text-align: right;">2023</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="even">
<td style="text-align: left;">Leyte</td>
<td style="text-align: left;">MULTIPOLYGON (((125.1739 10…</td>
<td style="text-align: right;">2016</td>
<td style="text-align: right;">18</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Leyte</td>
<td style="text-align: left;">MULTIPOLYGON (((125.1739 10…</td>
<td style="text-align: right;">2017</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="even">
<td style="text-align: left;">Leyte</td>
<td style="text-align: left;">MULTIPOLYGON (((125.1739 10…</td>
<td style="text-align: right;">2018</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Leyte</td>
<td style="text-align: left;">MULTIPOLYGON (((125.1739 10…</td>
<td style="text-align: right;">2019</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="even">
<td style="text-align: left;">Leyte</td>
<td style="text-align: left;">MULTIPOLYGON (((125.1739 10…</td>
<td style="text-align: right;">2020</td>
<td style="text-align: right;">10</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Leyte</td>
<td style="text-align: left;">MULTIPOLYGON (((125.1739 10…</td>
<td style="text-align: right;">2021</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Leyte</td>
<td style="text-align: left;">MULTIPOLYGON (((125.1739 10…</td>
<td style="text-align: right;">2022</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Leyte</td>
<td style="text-align: left;">MULTIPOLYGON (((125.1739 10…</td>
<td style="text-align: right;">2023</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="even">
<td style="text-align: left;">Leyte</td>
<td style="text-align: left;">MULTIPOLYGON (((125.1739 10…</td>
<td style="text-align: right;">2024</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Maguindanao del Norte</td>
<td style="text-align: left;">MULTIPOLYGON (((124.4633 7….</td>
<td style="text-align: right;">2016</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Maguindanao del Norte</td>
<td style="text-align: left;">MULTIPOLYGON (((124.4633 7….</td>
<td style="text-align: right;">2017</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Maguindanao del Norte</td>
<td style="text-align: left;">MULTIPOLYGON (((124.4633 7….</td>
<td style="text-align: right;">2018</td>
<td style="text-align: right;">9</td>
</tr>
<tr class="even">
<td style="text-align: left;">Maguindanao del Norte</td>
<td style="text-align: left;">MULTIPOLYGON (((124.4633 7….</td>
<td style="text-align: right;">2019</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Maguindanao del Norte</td>
<td style="text-align: left;">MULTIPOLYGON (((124.4633 7….</td>
<td style="text-align: right;">2020</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="even">
<td style="text-align: left;">Maguindanao del Norte</td>
<td style="text-align: left;">MULTIPOLYGON (((124.4633 7….</td>
<td style="text-align: right;">2021</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Maguindanao del Norte</td>
<td style="text-align: left;">MULTIPOLYGON (((124.4633 7….</td>
<td style="text-align: right;">2022</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">Maguindanao del Norte</td>
<td style="text-align: left;">MULTIPOLYGON (((124.4633 7….</td>
<td style="text-align: right;">2023</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Maguindanao del Norte</td>
<td style="text-align: left;">MULTIPOLYGON (((124.4633 7….</td>
<td style="text-align: right;">2024</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Maguindanao del Sur</td>
<td style="text-align: left;">POLYGON ((124.7111 7.182233…</td>
<td style="text-align: right;">2016</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Maguindanao del Sur</td>
<td style="text-align: left;">POLYGON ((124.7111 7.182233…</td>
<td style="text-align: right;">2017</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: left;">Maguindanao del Sur</td>
<td style="text-align: left;">POLYGON ((124.7111 7.182233…</td>
<td style="text-align: right;">2018</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Maguindanao del Sur</td>
<td style="text-align: left;">POLYGON ((124.7111 7.182233…</td>
<td style="text-align: right;">2019</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: left;">Maguindanao del Sur</td>
<td style="text-align: left;">POLYGON ((124.7111 7.182233…</td>
<td style="text-align: right;">2020</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Maguindanao del Sur</td>
<td style="text-align: left;">POLYGON ((124.7111 7.182233…</td>
<td style="text-align: right;">2021</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: left;">Maguindanao del Sur</td>
<td style="text-align: left;">POLYGON ((124.7111 7.182233…</td>
<td style="text-align: right;">2022</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Maguindanao del Sur</td>
<td style="text-align: left;">POLYGON ((124.7111 7.182233…</td>
<td style="text-align: right;">2024</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">Marinduque</td>
<td style="text-align: left;">MULTIPOLYGON (((122.0257 13…</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Masbate</td>
<td style="text-align: left;">MULTIPOLYGON (((122.9371 13…</td>
<td style="text-align: right;">2016</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="even">
<td style="text-align: left;">Masbate</td>
<td style="text-align: left;">MULTIPOLYGON (((122.9371 13…</td>
<td style="text-align: right;">2017</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Masbate</td>
<td style="text-align: left;">MULTIPOLYGON (((122.9371 13…</td>
<td style="text-align: right;">2018</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Masbate</td>
<td style="text-align: left;">MULTIPOLYGON (((122.9371 13…</td>
<td style="text-align: right;">2019</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Masbate</td>
<td style="text-align: left;">MULTIPOLYGON (((122.9371 13…</td>
<td style="text-align: right;">2021</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Masbate</td>
<td style="text-align: left;">MULTIPOLYGON (((122.9371 13…</td>
<td style="text-align: right;">2023</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Metro Manila</td>
<td style="text-align: left;">POLYGON ((121.1036 14.53224…</td>
<td style="text-align: right;">2016</td>
<td style="text-align: right;">783</td>
</tr>
<tr class="even">
<td style="text-align: left;">Metro Manila</td>
<td style="text-align: left;">POLYGON ((121.1036 14.53224…</td>
<td style="text-align: right;">2017</td>
<td style="text-align: right;">475</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Metro Manila</td>
<td style="text-align: left;">POLYGON ((121.1036 14.53224…</td>
<td style="text-align: right;">2018</td>
<td style="text-align: right;">175</td>
</tr>
<tr class="even">
<td style="text-align: left;">Metro Manila</td>
<td style="text-align: left;">POLYGON ((121.1036 14.53224…</td>
<td style="text-align: right;">2019</td>
<td style="text-align: right;">106</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Metro Manila</td>
<td style="text-align: left;">POLYGON ((121.1036 14.53224…</td>
<td style="text-align: right;">2020</td>
<td style="text-align: right;">76</td>
</tr>
<tr class="even">
<td style="text-align: left;">Metro Manila</td>
<td style="text-align: left;">POLYGON ((121.1036 14.53224…</td>
<td style="text-align: right;">2021</td>
<td style="text-align: right;">42</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Metro Manila</td>
<td style="text-align: left;">POLYGON ((121.1036 14.53224…</td>
<td style="text-align: right;">2022</td>
<td style="text-align: right;">31</td>
</tr>
<tr class="even">
<td style="text-align: left;">Metro Manila</td>
<td style="text-align: left;">POLYGON ((121.1036 14.53224…</td>
<td style="text-align: right;">2023</td>
<td style="text-align: right;">22</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Metro Manila</td>
<td style="text-align: left;">POLYGON ((121.1036 14.53224…</td>
<td style="text-align: right;">2024</td>
<td style="text-align: right;">9</td>
</tr>
<tr class="even">
<td style="text-align: left;">Misamis Occidental</td>
<td style="text-align: left;">MULTIPOLYGON (((123.634 8.0…</td>
<td style="text-align: right;">2016</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Misamis Occidental</td>
<td style="text-align: left;">MULTIPOLYGON (((123.634 8.0…</td>
<td style="text-align: right;">2017</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">Misamis Occidental</td>
<td style="text-align: left;">MULTIPOLYGON (((123.634 8.0…</td>
<td style="text-align: right;">2018</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Misamis Occidental</td>
<td style="text-align: left;">MULTIPOLYGON (((123.634 8.0…</td>
<td style="text-align: right;">2019</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Misamis Oriental</td>
<td style="text-align: left;">POLYGON ((125.2386 8.747398…</td>
<td style="text-align: right;">2016</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Misamis Oriental</td>
<td style="text-align: left;">POLYGON ((125.2386 8.747398…</td>
<td style="text-align: right;">2017</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="even">
<td style="text-align: left;">Misamis Oriental</td>
<td style="text-align: left;">POLYGON ((125.2386 8.747398…</td>
<td style="text-align: right;">2018</td>
<td style="text-align: right;">21</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Misamis Oriental</td>
<td style="text-align: left;">POLYGON ((125.2386 8.747398…</td>
<td style="text-align: right;">2019</td>
<td style="text-align: right;">20</td>
</tr>
<tr class="even">
<td style="text-align: left;">Misamis Oriental</td>
<td style="text-align: left;">POLYGON ((125.2386 8.747398…</td>
<td style="text-align: right;">2020</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Misamis Oriental</td>
<td style="text-align: left;">POLYGON ((125.2386 8.747398…</td>
<td style="text-align: right;">2021</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">Misamis Oriental</td>
<td style="text-align: left;">POLYGON ((125.2386 8.747398…</td>
<td style="text-align: right;">2022</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Misamis Oriental</td>
<td style="text-align: left;">POLYGON ((125.2386 8.747398…</td>
<td style="text-align: right;">2023</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Mountain Province</td>
<td style="text-align: left;">POLYGON ((121.5327 17.2691,…</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Negros Occidental</td>
<td style="text-align: left;">MULTIPOLYGON (((123.2035 11…</td>
<td style="text-align: right;">2016</td>
<td style="text-align: right;">14</td>
</tr>
<tr class="even">
<td style="text-align: left;">Negros Occidental</td>
<td style="text-align: left;">MULTIPOLYGON (((123.2035 11…</td>
<td style="text-align: right;">2017</td>
<td style="text-align: right;">14</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Negros Occidental</td>
<td style="text-align: left;">MULTIPOLYGON (((123.2035 11…</td>
<td style="text-align: right;">2018</td>
<td style="text-align: right;">19</td>
</tr>
<tr class="even">
<td style="text-align: left;">Negros Occidental</td>
<td style="text-align: left;">MULTIPOLYGON (((123.2035 11…</td>
<td style="text-align: right;">2019</td>
<td style="text-align: right;">26</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Negros Occidental</td>
<td style="text-align: left;">MULTIPOLYGON (((123.2035 11…</td>
<td style="text-align: right;">2020</td>
<td style="text-align: right;">29</td>
</tr>
<tr class="even">
<td style="text-align: left;">Negros Occidental</td>
<td style="text-align: left;">MULTIPOLYGON (((123.2035 11…</td>
<td style="text-align: right;">2021</td>
<td style="text-align: right;">23</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Negros Occidental</td>
<td style="text-align: left;">MULTIPOLYGON (((123.2035 11…</td>
<td style="text-align: right;">2022</td>
<td style="text-align: right;">23</td>
</tr>
<tr class="even">
<td style="text-align: left;">Negros Occidental</td>
<td style="text-align: left;">MULTIPOLYGON (((123.2035 11…</td>
<td style="text-align: right;">2023</td>
<td style="text-align: right;">16</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Negros Occidental</td>
<td style="text-align: left;">MULTIPOLYGON (((123.2035 11…</td>
<td style="text-align: right;">2024</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="even">
<td style="text-align: left;">Negros Oriental</td>
<td style="text-align: left;">MULTIPOLYGON (((123.3355 10…</td>
<td style="text-align: right;">2016</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Negros Oriental</td>
<td style="text-align: left;">MULTIPOLYGON (((123.3355 10…</td>
<td style="text-align: right;">2017</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="even">
<td style="text-align: left;">Negros Oriental</td>
<td style="text-align: left;">MULTIPOLYGON (((123.3355 10…</td>
<td style="text-align: right;">2018</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Negros Oriental</td>
<td style="text-align: left;">MULTIPOLYGON (((123.3355 10…</td>
<td style="text-align: right;">2019</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="even">
<td style="text-align: left;">Negros Oriental</td>
<td style="text-align: left;">MULTIPOLYGON (((123.3355 10…</td>
<td style="text-align: right;">2020</td>
<td style="text-align: right;">11</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Negros Oriental</td>
<td style="text-align: left;">MULTIPOLYGON (((123.3355 10…</td>
<td style="text-align: right;">2022</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">Negros Oriental</td>
<td style="text-align: left;">MULTIPOLYGON (((123.3355 10…</td>
<td style="text-align: right;">2023</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Northern Samar</td>
<td style="text-align: left;">MULTIPOLYGON (((124.3675 12…</td>
<td style="text-align: right;">2016</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Northern Samar</td>
<td style="text-align: left;">MULTIPOLYGON (((124.3675 12…</td>
<td style="text-align: right;">2017</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Nueva Ecija</td>
<td style="text-align: left;">POLYGON ((121.0633 16.13207…</td>
<td style="text-align: right;">2016</td>
<td style="text-align: right;">89</td>
</tr>
<tr class="even">
<td style="text-align: left;">Nueva Ecija</td>
<td style="text-align: left;">POLYGON ((121.0633 16.13207…</td>
<td style="text-align: right;">2017</td>
<td style="text-align: right;">35</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Nueva Ecija</td>
<td style="text-align: left;">POLYGON ((121.0633 16.13207…</td>
<td style="text-align: right;">2018</td>
<td style="text-align: right;">40</td>
</tr>
<tr class="even">
<td style="text-align: left;">Nueva Ecija</td>
<td style="text-align: left;">POLYGON ((121.0633 16.13207…</td>
<td style="text-align: right;">2019</td>
<td style="text-align: right;">47</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Nueva Ecija</td>
<td style="text-align: left;">POLYGON ((121.0633 16.13207…</td>
<td style="text-align: right;">2020</td>
<td style="text-align: right;">35</td>
</tr>
<tr class="even">
<td style="text-align: left;">Nueva Ecija</td>
<td style="text-align: left;">POLYGON ((121.0633 16.13207…</td>
<td style="text-align: right;">2021</td>
<td style="text-align: right;">50</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Nueva Ecija</td>
<td style="text-align: left;">POLYGON ((121.0633 16.13207…</td>
<td style="text-align: right;">2022</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: left;">Nueva Ecija</td>
<td style="text-align: left;">POLYGON ((121.0633 16.13207…</td>
<td style="text-align: right;">2023</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Nueva Vizcaya</td>
<td style="text-align: left;">POLYGON ((121.4324 16.63831…</td>
<td style="text-align: right;">2016</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="even">
<td style="text-align: left;">Nueva Vizcaya</td>
<td style="text-align: left;">POLYGON ((121.4324 16.63831…</td>
<td style="text-align: right;">2017</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Nueva Vizcaya</td>
<td style="text-align: left;">POLYGON ((121.4324 16.63831…</td>
<td style="text-align: right;">2018</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Occidental Mindoro</td>
<td style="text-align: left;">MULTIPOLYGON (((120.0454 13…</td>
<td style="text-align: right;">2017</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Occidental Mindoro</td>
<td style="text-align: left;">MULTIPOLYGON (((120.0454 13…</td>
<td style="text-align: right;">2018</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Occidental Mindoro</td>
<td style="text-align: left;">MULTIPOLYGON (((120.0454 13…</td>
<td style="text-align: right;">2019</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Occidental Mindoro</td>
<td style="text-align: left;">MULTIPOLYGON (((120.0454 13…</td>
<td style="text-align: right;">2021</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Oriental Mindoro</td>
<td style="text-align: left;">MULTIPOLYGON (((121.2841 12…</td>
<td style="text-align: right;">2016</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Oriental Mindoro</td>
<td style="text-align: left;">MULTIPOLYGON (((121.2841 12…</td>
<td style="text-align: right;">2017</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">Oriental Mindoro</td>
<td style="text-align: left;">MULTIPOLYGON (((121.2841 12…</td>
<td style="text-align: right;">2018</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Oriental Mindoro</td>
<td style="text-align: left;">MULTIPOLYGON (((121.2841 12…</td>
<td style="text-align: right;">2019</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Oriental Mindoro</td>
<td style="text-align: left;">MULTIPOLYGON (((121.2841 12…</td>
<td style="text-align: right;">2020</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Oriental Mindoro</td>
<td style="text-align: left;">MULTIPOLYGON (((121.2841 12…</td>
<td style="text-align: right;">2023</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Palawan</td>
<td style="text-align: left;">MULTIPOLYGON (((119.8987 12…</td>
<td style="text-align: right;">2017</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Palawan</td>
<td style="text-align: left;">MULTIPOLYGON (((119.8987 12…</td>
<td style="text-align: right;">2018</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: left;">Pampanga</td>
<td style="text-align: left;">POLYGON ((120.7304 15.27495…</td>
<td style="text-align: right;">2016</td>
<td style="text-align: right;">33</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Pampanga</td>
<td style="text-align: left;">POLYGON ((120.7304 15.27495…</td>
<td style="text-align: right;">2017</td>
<td style="text-align: right;">24</td>
</tr>
<tr class="even">
<td style="text-align: left;">Pampanga</td>
<td style="text-align: left;">POLYGON ((120.7304 15.27495…</td>
<td style="text-align: right;">2018</td>
<td style="text-align: right;">16</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Pampanga</td>
<td style="text-align: left;">POLYGON ((120.7304 15.27495…</td>
<td style="text-align: right;">2019</td>
<td style="text-align: right;">21</td>
</tr>
<tr class="even">
<td style="text-align: left;">Pampanga</td>
<td style="text-align: left;">POLYGON ((120.7304 15.27495…</td>
<td style="text-align: right;">2020</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Pampanga</td>
<td style="text-align: left;">POLYGON ((120.7304 15.27495…</td>
<td style="text-align: right;">2021</td>
<td style="text-align: right;">9</td>
</tr>
<tr class="even">
<td style="text-align: left;">Pampanga</td>
<td style="text-align: left;">POLYGON ((120.7304 15.27495…</td>
<td style="text-align: right;">2022</td>
<td style="text-align: right;">14</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Pampanga</td>
<td style="text-align: left;">POLYGON ((120.7304 15.27495…</td>
<td style="text-align: right;">2023</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">Pangasinan</td>
<td style="text-align: left;">MULTIPOLYGON (((119.9228 16…</td>
<td style="text-align: right;">2016</td>
<td style="text-align: right;">101</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Pangasinan</td>
<td style="text-align: left;">MULTIPOLYGON (((119.9228 16…</td>
<td style="text-align: right;">2017</td>
<td style="text-align: right;">23</td>
</tr>
<tr class="even">
<td style="text-align: left;">Pangasinan</td>
<td style="text-align: left;">MULTIPOLYGON (((119.9228 16…</td>
<td style="text-align: right;">2018</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Pangasinan</td>
<td style="text-align: left;">MULTIPOLYGON (((119.9228 16…</td>
<td style="text-align: right;">2019</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="even">
<td style="text-align: left;">Pangasinan</td>
<td style="text-align: left;">MULTIPOLYGON (((119.9228 16…</td>
<td style="text-align: right;">2020</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Pangasinan</td>
<td style="text-align: left;">MULTIPOLYGON (((119.9228 16…</td>
<td style="text-align: right;">2021</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">Pangasinan</td>
<td style="text-align: left;">MULTIPOLYGON (((119.9228 16…</td>
<td style="text-align: right;">2024</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Quezon</td>
<td style="text-align: left;">MULTIPOLYGON (((122.3057 14…</td>
<td style="text-align: right;">2016</td>
<td style="text-align: right;">51</td>
</tr>
<tr class="even">
<td style="text-align: left;">Quezon</td>
<td style="text-align: left;">MULTIPOLYGON (((122.3057 14…</td>
<td style="text-align: right;">2017</td>
<td style="text-align: right;">16</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Quezon</td>
<td style="text-align: left;">MULTIPOLYGON (((122.3057 14…</td>
<td style="text-align: right;">2018</td>
<td style="text-align: right;">29</td>
</tr>
<tr class="even">
<td style="text-align: left;">Quezon</td>
<td style="text-align: left;">MULTIPOLYGON (((122.3057 14…</td>
<td style="text-align: right;">2019</td>
<td style="text-align: right;">36</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Quezon</td>
<td style="text-align: left;">MULTIPOLYGON (((122.3057 14…</td>
<td style="text-align: right;">2020</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="even">
<td style="text-align: left;">Quezon</td>
<td style="text-align: left;">MULTIPOLYGON (((122.3057 14…</td>
<td style="text-align: right;">2021</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Quezon</td>
<td style="text-align: left;">MULTIPOLYGON (((122.3057 14…</td>
<td style="text-align: right;">2022</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="even">
<td style="text-align: left;">Quezon</td>
<td style="text-align: left;">MULTIPOLYGON (((122.3057 14…</td>
<td style="text-align: right;">2023</td>
<td style="text-align: right;">10</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Quezon</td>
<td style="text-align: left;">MULTIPOLYGON (((122.3057 14…</td>
<td style="text-align: right;">2024</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: left;">Quirino</td>
<td style="text-align: left;">POLYGON ((122.0177 16.51702…</td>
<td style="text-align: right;">2016</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Quirino</td>
<td style="text-align: left;">POLYGON ((122.0177 16.51702…</td>
<td style="text-align: right;">2018</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Rizal</td>
<td style="text-align: left;">MULTIPOLYGON (((121.4501 14…</td>
<td style="text-align: right;">2016</td>
<td style="text-align: right;">62</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Rizal</td>
<td style="text-align: left;">MULTIPOLYGON (((121.4501 14…</td>
<td style="text-align: right;">2017</td>
<td style="text-align: right;">30</td>
</tr>
<tr class="even">
<td style="text-align: left;">Rizal</td>
<td style="text-align: left;">MULTIPOLYGON (((121.4501 14…</td>
<td style="text-align: right;">2018</td>
<td style="text-align: right;">29</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Rizal</td>
<td style="text-align: left;">MULTIPOLYGON (((121.4501 14…</td>
<td style="text-align: right;">2019</td>
<td style="text-align: right;">10</td>
</tr>
<tr class="even">
<td style="text-align: left;">Rizal</td>
<td style="text-align: left;">MULTIPOLYGON (((121.4501 14…</td>
<td style="text-align: right;">2020</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Rizal</td>
<td style="text-align: left;">MULTIPOLYGON (((121.4501 14…</td>
<td style="text-align: right;">2021</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="even">
<td style="text-align: left;">Rizal</td>
<td style="text-align: left;">MULTIPOLYGON (((121.4501 14…</td>
<td style="text-align: right;">2022</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Rizal</td>
<td style="text-align: left;">MULTIPOLYGON (((121.4501 14…</td>
<td style="text-align: right;">2023</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="even">
<td style="text-align: left;">Rizal</td>
<td style="text-align: left;">MULTIPOLYGON (((121.4501 14…</td>
<td style="text-align: right;">2024</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Romblon</td>
<td style="text-align: left;">MULTIPOLYGON (((122.033 12….</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="even">
<td style="text-align: left;">Samar</td>
<td style="text-align: left;">MULTIPOLYGON (((125.1508 12…</td>
<td style="text-align: right;">2016</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Samar</td>
<td style="text-align: left;">MULTIPOLYGON (((125.1508 12…</td>
<td style="text-align: right;">2017</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: left;">Samar</td>
<td style="text-align: left;">MULTIPOLYGON (((125.1508 12…</td>
<td style="text-align: right;">2020</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Samar</td>
<td style="text-align: left;">MULTIPOLYGON (((125.1508 12…</td>
<td style="text-align: right;">2021</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">Samar</td>
<td style="text-align: left;">MULTIPOLYGON (((125.1508 12…</td>
<td style="text-align: right;">2023</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Samar</td>
<td style="text-align: left;">MULTIPOLYGON (((125.1508 12…</td>
<td style="text-align: right;">2024</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Sarangani</td>
<td style="text-align: left;">MULTIPOLYGON (((125.398 6.4…</td>
<td style="text-align: right;">2018</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Sarangani</td>
<td style="text-align: left;">MULTIPOLYGON (((125.398 6.4…</td>
<td style="text-align: right;">2019</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="even">
<td style="text-align: left;">Sarangani</td>
<td style="text-align: left;">MULTIPOLYGON (((125.398 6.4…</td>
<td style="text-align: right;">2020</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Siquijor</td>
<td style="text-align: left;">POLYGON ((123.6122 9.300828…</td>
<td style="text-align: right;">2018</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Sorsogon</td>
<td style="text-align: left;">MULTIPOLYGON (((123.4823 12…</td>
<td style="text-align: right;">2016</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Sorsogon</td>
<td style="text-align: left;">MULTIPOLYGON (((123.4823 12…</td>
<td style="text-align: right;">2017</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: left;">Sorsogon</td>
<td style="text-align: left;">MULTIPOLYGON (((123.4823 12…</td>
<td style="text-align: right;">2018</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Sorsogon</td>
<td style="text-align: left;">MULTIPOLYGON (((123.4823 12…</td>
<td style="text-align: right;">2019</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Sorsogon</td>
<td style="text-align: left;">MULTIPOLYGON (((123.4823 12…</td>
<td style="text-align: right;">2020</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Sorsogon</td>
<td style="text-align: left;">MULTIPOLYGON (((123.4823 12…</td>
<td style="text-align: right;">2021</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">South Cotabato</td>
<td style="text-align: left;">POLYGON ((125.0954 6.532886…</td>
<td style="text-align: right;">2016</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="odd">
<td style="text-align: left;">South Cotabato</td>
<td style="text-align: left;">POLYGON ((125.0954 6.532886…</td>
<td style="text-align: right;">2017</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="even">
<td style="text-align: left;">South Cotabato</td>
<td style="text-align: left;">POLYGON ((125.0954 6.532886…</td>
<td style="text-align: right;">2018</td>
<td style="text-align: right;">22</td>
</tr>
<tr class="odd">
<td style="text-align: left;">South Cotabato</td>
<td style="text-align: left;">POLYGON ((125.0954 6.532886…</td>
<td style="text-align: right;">2019</td>
<td style="text-align: right;">9</td>
</tr>
<tr class="even">
<td style="text-align: left;">South Cotabato</td>
<td style="text-align: left;">POLYGON ((125.0954 6.532886…</td>
<td style="text-align: right;">2020</td>
<td style="text-align: right;">29</td>
</tr>
<tr class="odd">
<td style="text-align: left;">South Cotabato</td>
<td style="text-align: left;">POLYGON ((125.0954 6.532886…</td>
<td style="text-align: right;">2021</td>
<td style="text-align: right;">9</td>
</tr>
<tr class="even">
<td style="text-align: left;">South Cotabato</td>
<td style="text-align: left;">POLYGON ((125.0954 6.532886…</td>
<td style="text-align: right;">2024</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Southern Leyte</td>
<td style="text-align: left;">MULTIPOLYGON (((125.1739 10…</td>
<td style="text-align: right;">2016</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Southern Leyte</td>
<td style="text-align: left;">MULTIPOLYGON (((125.1739 10…</td>
<td style="text-align: right;">2017</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Southern Leyte</td>
<td style="text-align: left;">MULTIPOLYGON (((125.1739 10…</td>
<td style="text-align: right;">2019</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">Southern Leyte</td>
<td style="text-align: left;">MULTIPOLYGON (((125.1739 10…</td>
<td style="text-align: right;">2020</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Southern Leyte</td>
<td style="text-align: left;">MULTIPOLYGON (((125.1739 10…</td>
<td style="text-align: right;">2021</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">Special Geographic Area</td>
<td style="text-align: left;">MULTIPOLYGON (((124.406 7.3…</td>
<td style="text-align: right;">NA</td>
<td style="text-align: right;">NA</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Sultan Kudarat</td>
<td style="text-align: left;">POLYGON ((125.0068 6.711873…</td>
<td style="text-align: right;">2016</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="even">
<td style="text-align: left;">Sultan Kudarat</td>
<td style="text-align: left;">POLYGON ((125.0068 6.711873…</td>
<td style="text-align: right;">2017</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Sultan Kudarat</td>
<td style="text-align: left;">POLYGON ((125.0068 6.711873…</td>
<td style="text-align: right;">2018</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="even">
<td style="text-align: left;">Sultan Kudarat</td>
<td style="text-align: left;">POLYGON ((125.0068 6.711873…</td>
<td style="text-align: right;">2019</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Sultan Kudarat</td>
<td style="text-align: left;">POLYGON ((125.0068 6.711873…</td>
<td style="text-align: right;">2020</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">Sultan Kudarat</td>
<td style="text-align: left;">POLYGON ((125.0068 6.711873…</td>
<td style="text-align: right;">2022</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Sultan Kudarat</td>
<td style="text-align: left;">POLYGON ((125.0068 6.711873…</td>
<td style="text-align: right;">2023</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Sulu</td>
<td style="text-align: left;">MULTIPOLYGON (((120.6989 6….</td>
<td style="text-align: right;">2016</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Sulu</td>
<td style="text-align: left;">MULTIPOLYGON (((120.6989 6….</td>
<td style="text-align: right;">2017</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="even">
<td style="text-align: left;">Sulu</td>
<td style="text-align: left;">MULTIPOLYGON (((120.6989 6….</td>
<td style="text-align: right;">2019</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Sulu</td>
<td style="text-align: left;">MULTIPOLYGON (((120.6989 6….</td>
<td style="text-align: right;">2020</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Sulu</td>
<td style="text-align: left;">MULTIPOLYGON (((120.6989 6….</td>
<td style="text-align: right;">2021</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Sulu</td>
<td style="text-align: left;">MULTIPOLYGON (((120.6989 6….</td>
<td style="text-align: right;">2022</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Sulu</td>
<td style="text-align: left;">MULTIPOLYGON (((120.6989 6….</td>
<td style="text-align: right;">2023</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Sulu</td>
<td style="text-align: left;">MULTIPOLYGON (((120.6989 6….</td>
<td style="text-align: right;">2024</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">Surigao del Norte</td>
<td style="text-align: left;">MULTIPOLYGON (((126.0613 10…</td>
<td style="text-align: right;">2016</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Surigao del Norte</td>
<td style="text-align: left;">MULTIPOLYGON (((126.0613 10…</td>
<td style="text-align: right;">2017</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Surigao del Norte</td>
<td style="text-align: left;">MULTIPOLYGON (((126.0613 10…</td>
<td style="text-align: right;">2018</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Surigao del Norte</td>
<td style="text-align: left;">MULTIPOLYGON (((126.0613 10…</td>
<td style="text-align: right;">2019</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Surigao del Norte</td>
<td style="text-align: left;">MULTIPOLYGON (((126.0613 10…</td>
<td style="text-align: right;">2020</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Surigao del Sur</td>
<td style="text-align: left;">MULTIPOLYGON (((126.3685 7….</td>
<td style="text-align: right;">2016</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">Surigao del Sur</td>
<td style="text-align: left;">MULTIPOLYGON (((126.3685 7….</td>
<td style="text-align: right;">2019</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Tarlac</td>
<td style="text-align: left;">POLYGON ((120.6121 15.83029…</td>
<td style="text-align: right;">2016</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="even">
<td style="text-align: left;">Tarlac</td>
<td style="text-align: left;">POLYGON ((120.6121 15.83029…</td>
<td style="text-align: right;">2017</td>
<td style="text-align: right;">14</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Tarlac</td>
<td style="text-align: left;">POLYGON ((120.6121 15.83029…</td>
<td style="text-align: right;">2018</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="even">
<td style="text-align: left;">Tarlac</td>
<td style="text-align: left;">POLYGON ((120.6121 15.83029…</td>
<td style="text-align: right;">2019</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Tarlac</td>
<td style="text-align: left;">POLYGON ((120.6121 15.83029…</td>
<td style="text-align: right;">2020</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: left;">Tarlac</td>
<td style="text-align: left;">POLYGON ((120.6121 15.83029…</td>
<td style="text-align: right;">2021</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Tarlac</td>
<td style="text-align: left;">POLYGON ((120.6121 15.83029…</td>
<td style="text-align: right;">2022</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Tawi-Tawi</td>
<td style="text-align: left;">MULTIPOLYGON (((118.4204 7….</td>
<td style="text-align: right;">2018</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Tawi-Tawi</td>
<td style="text-align: left;">MULTIPOLYGON (((118.4204 7….</td>
<td style="text-align: right;">2019</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">Tawi-Tawi</td>
<td style="text-align: left;">MULTIPOLYGON (((118.4204 7….</td>
<td style="text-align: right;">2020</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Tawi-Tawi</td>
<td style="text-align: left;">MULTIPOLYGON (((118.4204 7….</td>
<td style="text-align: right;">2021</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="even">
<td style="text-align: left;">Tawi-Tawi</td>
<td style="text-align: left;">MULTIPOLYGON (((118.4204 7….</td>
<td style="text-align: right;">2022</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Tawi-Tawi</td>
<td style="text-align: left;">MULTIPOLYGON (((118.4204 7….</td>
<td style="text-align: right;">2023</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Tawi-Tawi</td>
<td style="text-align: left;">MULTIPOLYGON (((118.4204 7….</td>
<td style="text-align: right;">2024</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Zambales</td>
<td style="text-align: left;">MULTIPOLYGON (((120.2523 15…</td>
<td style="text-align: right;">2016</td>
<td style="text-align: right;">25</td>
</tr>
<tr class="even">
<td style="text-align: left;">Zambales</td>
<td style="text-align: left;">MULTIPOLYGON (((120.2523 15…</td>
<td style="text-align: right;">2017</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Zambales</td>
<td style="text-align: left;">MULTIPOLYGON (((120.2523 15…</td>
<td style="text-align: right;">2019</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: left;">Zambales</td>
<td style="text-align: left;">MULTIPOLYGON (((120.2523 15…</td>
<td style="text-align: right;">2020</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Zambales</td>
<td style="text-align: left;">MULTIPOLYGON (((120.2523 15…</td>
<td style="text-align: right;">2021</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="even">
<td style="text-align: left;">Zambales</td>
<td style="text-align: left;">MULTIPOLYGON (((120.2523 15…</td>
<td style="text-align: right;">2023</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Zamboanga Sibugay</td>
<td style="text-align: left;">MULTIPOLYGON (((122.9196 7….</td>
<td style="text-align: right;">2016</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: left;">Zamboanga Sibugay</td>
<td style="text-align: left;">MULTIPOLYGON (((122.9196 7….</td>
<td style="text-align: right;">2017</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Zamboanga Sibugay</td>
<td style="text-align: left;">MULTIPOLYGON (((122.9196 7….</td>
<td style="text-align: right;">2018</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: left;">Zamboanga Sibugay</td>
<td style="text-align: left;">MULTIPOLYGON (((122.9196 7….</td>
<td style="text-align: right;">2019</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Zamboanga Sibugay</td>
<td style="text-align: left;">MULTIPOLYGON (((122.9196 7….</td>
<td style="text-align: right;">2020</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Zamboanga Sibugay</td>
<td style="text-align: left;">MULTIPOLYGON (((122.9196 7….</td>
<td style="text-align: right;">2021</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Zamboanga Sibugay</td>
<td style="text-align: left;">MULTIPOLYGON (((122.9196 7….</td>
<td style="text-align: right;">2022</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Zamboanga Sibugay</td>
<td style="text-align: left;">MULTIPOLYGON (((122.9196 7….</td>
<td style="text-align: right;">2024</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Zamboanga del Norte</td>
<td style="text-align: left;">MULTIPOLYGON (((123.4132 8….</td>
<td style="text-align: right;">2016</td>
<td style="text-align: right;">9</td>
</tr>
<tr class="even">
<td style="text-align: left;">Zamboanga del Norte</td>
<td style="text-align: left;">MULTIPOLYGON (((123.4132 8….</td>
<td style="text-align: right;">2017</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Zamboanga del Norte</td>
<td style="text-align: left;">MULTIPOLYGON (((123.4132 8….</td>
<td style="text-align: right;">2018</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Zamboanga del Norte</td>
<td style="text-align: left;">MULTIPOLYGON (((123.4132 8….</td>
<td style="text-align: right;">2019</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Zamboanga del Norte</td>
<td style="text-align: left;">MULTIPOLYGON (((123.4132 8….</td>
<td style="text-align: right;">2020</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">Zamboanga del Norte</td>
<td style="text-align: left;">MULTIPOLYGON (((123.4132 8….</td>
<td style="text-align: right;">2023</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Zamboanga del Sur</td>
<td style="text-align: left;">MULTIPOLYGON (((123.5583 8….</td>
<td style="text-align: right;">2016</td>
<td style="text-align: right;">17</td>
</tr>
<tr class="even">
<td style="text-align: left;">Zamboanga del Sur</td>
<td style="text-align: left;">MULTIPOLYGON (((123.5583 8….</td>
<td style="text-align: right;">2017</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Zamboanga del Sur</td>
<td style="text-align: left;">MULTIPOLYGON (((123.5583 8….</td>
<td style="text-align: right;">2018</td>
<td style="text-align: right;">9</td>
</tr>
<tr class="even">
<td style="text-align: left;">Zamboanga del Sur</td>
<td style="text-align: left;">MULTIPOLYGON (((123.5583 8….</td>
<td style="text-align: right;">2019</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Zamboanga del Sur</td>
<td style="text-align: left;">MULTIPOLYGON (((123.5583 8….</td>
<td style="text-align: right;">2020</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: left;">Zamboanga del Sur</td>
<td style="text-align: left;">MULTIPOLYGON (((123.5583 8….</td>
<td style="text-align: right;">2021</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Zamboanga del Sur</td>
<td style="text-align: left;">MULTIPOLYGON (((123.5583 8….</td>
<td style="text-align: right;">2022</td>
<td style="text-align: right;">7</td>
</tr>
<tr class="even">
<td style="text-align: left;">Zamboanga del Sur</td>
<td style="text-align: left;">MULTIPOLYGON (((123.5583 8….</td>
<td style="text-align: right;">2023</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Zamboanga del Sur</td>
<td style="text-align: left;">MULTIPOLYGON (((123.5583 8….</td>
<td style="text-align: right;">2024</td>
<td style="text-align: right;">2</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>As you can see, there are some rows with <code>NA</code> values. That is because not all provinces have drug event information. Hence, some rows are not able to join correctly. We will have to remove them.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>province_drug_stats <span class="ot">&lt;-</span> province_drug_stats <span class="sc">%&gt;%</span> <span class="fu">na.omit</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Note that we will end up not using <code>province_drug_stats</code> but <code>province_drug_stats_all</code> instead for the rest of this exercise, but I will still leave this in for illustrative purposes and/or if I decide to use the former again for some reason in the future.</p>
</div>
</div>
<p>We are also going to prepare a copy that is not delineated by year, but by the entire duration. This is such that we are able to perform spatial point patterns analysis on the entire duration of 2016-2024.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>drug_data_year_agg <span class="ot">&lt;-</span> drugs_data <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="dv">3</span>, <span class="dv">20</span>) <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(admin2) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">num_events =</span> <span class="fu">n</span>(), <span class="at">.groups =</span> <span class="st">"drop"</span>) <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="at">ADM2_EN =</span> admin2)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>province_drug_stats_all <span class="ot">&lt;-</span> <span class="fu">left_join</span>(merged_provinces_sf, drug_data_year_agg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Joining with `by = join_by(ADM2_EN)`</code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>province_drug_stats_all <span class="ot">&lt;-</span> province_drug_stats_all <span class="sc">%&gt;%</span> <span class="fu">na.omit</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>province_drug_stats_all <span class="sc">%&gt;%</span> <span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">ADM2_EN</th>
<th style="text-align: left;">geometry</th>
<th style="text-align: right;">num_events</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Abra</td>
<td style="text-align: left;">POLYGON ((121.1088 17.73945…</td>
<td style="text-align: right;">12</td>
</tr>
<tr class="even">
<td style="text-align: left;">Agusan del Norte</td>
<td style="text-align: left;">MULTIPOLYGON (((125.5546 9….</td>
<td style="text-align: right;">22</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Agusan del Sur</td>
<td style="text-align: left;">POLYGON ((126.2278 8.000244…</td>
<td style="text-align: right;">19</td>
</tr>
<tr class="even">
<td style="text-align: left;">Aklan</td>
<td style="text-align: left;">MULTIPOLYGON (((121.9216 11…</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Albay</td>
<td style="text-align: left;">MULTIPOLYGON (((123.6012 13…</td>
<td style="text-align: right;">71</td>
</tr>
<tr class="even">
<td style="text-align: left;">Antique</td>
<td style="text-align: left;">MULTIPOLYGON (((121.4341 12…</td>
<td style="text-align: right;">13</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Apayao</td>
<td style="text-align: left;">POLYGON ((121.4351 17.697, …</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: left;">Basilan</td>
<td style="text-align: left;">MULTIPOLYGON (((121.9913 6….</td>
<td style="text-align: right;">13</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Bataan</td>
<td style="text-align: left;">POLYGON ((120.5541 14.82082…</td>
<td style="text-align: right;">35</td>
</tr>
<tr class="even">
<td style="text-align: left;">Batangas</td>
<td style="text-align: left;">MULTIPOLYGON (((121.0889 13…</td>
<td style="text-align: right;">163</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Benguet</td>
<td style="text-align: left;">POLYGON ((120.7706 16.92119…</td>
<td style="text-align: right;">47</td>
</tr>
<tr class="even">
<td style="text-align: left;">Bohol</td>
<td style="text-align: left;">MULTIPOLYGON (((123.9225 9….</td>
<td style="text-align: right;">60</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Bukidnon</td>
<td style="text-align: left;">POLYGON ((125.092 8.583275,…</td>
<td style="text-align: right;">9</td>
</tr>
<tr class="even">
<td style="text-align: left;">Bulacan</td>
<td style="text-align: left;">POLYGON ((121.145 15.2722, …</td>
<td style="text-align: right;">885</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cagayan</td>
<td style="text-align: left;">MULTIPOLYGON (((121.9597 19…</td>
<td style="text-align: right;">81</td>
</tr>
<tr class="even">
<td style="text-align: left;">Camarines Norte</td>
<td style="text-align: left;">MULTIPOLYGON (((122.929 14….</td>
<td style="text-align: right;">59</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Camarines Sur</td>
<td style="text-align: left;">MULTIPOLYGON (((123.5704 13…</td>
<td style="text-align: right;">90</td>
</tr>
<tr class="even">
<td style="text-align: left;">Capiz</td>
<td style="text-align: left;">MULTIPOLYGON (((122.841 11….</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Catanduanes</td>
<td style="text-align: left;">MULTIPOLYGON (((124.2062 14…</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cavite</td>
<td style="text-align: left;">MULTIPOLYGON (((120.9699 14…</td>
<td style="text-align: right;">298</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Cebu</td>
<td style="text-align: left;">MULTIPOLYGON (((124.0931 11…</td>
<td style="text-align: right;">629</td>
</tr>
<tr class="even">
<td style="text-align: left;">Cotabato</td>
<td style="text-align: left;">MULTIPOLYGON (((124.7988 7….</td>
<td style="text-align: right;">78</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Davao Occidental</td>
<td style="text-align: left;">MULTIPOLYGON (((125.3171 5….</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Davao Oriental</td>
<td style="text-align: left;">MULTIPOLYGON (((126.3683 7….</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Davao de Oro</td>
<td style="text-align: left;">MULTIPOLYGON (((126.1577 7….</td>
<td style="text-align: right;">8</td>
</tr>
<tr class="even">
<td style="text-align: left;">Davao del Norte</td>
<td style="text-align: left;">MULTIPOLYGON (((125.3794 8….</td>
<td style="text-align: right;">15</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Davao del Sur</td>
<td style="text-align: left;">POLYGON ((125.68 7.261004, …</td>
<td style="text-align: right;">109</td>
</tr>
<tr class="even">
<td style="text-align: left;">Guimaras</td>
<td style="text-align: left;">MULTIPOLYGON (((122.4859 10…</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Ifugao</td>
<td style="text-align: left;">POLYGON ((121.5513 17.07884…</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Ilocos Norte</td>
<td style="text-align: left;">POLYGON ((120.9714 18.57995…</td>
<td style="text-align: right;">33</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Ilocos Sur</td>
<td style="text-align: left;">MULTIPOLYGON (((120.5406 17…</td>
<td style="text-align: right;">64</td>
</tr>
<tr class="even">
<td style="text-align: left;">Iloilo</td>
<td style="text-align: left;">MULTIPOLYGON (((123.3489 11…</td>
<td style="text-align: right;">68</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Isabela</td>
<td style="text-align: left;">MULTIPOLYGON (((122.1706 17…</td>
<td style="text-align: right;">124</td>
</tr>
<tr class="even">
<td style="text-align: left;">Kalinga</td>
<td style="text-align: left;">POLYGON ((121.6396 17.50436…</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">La Union</td>
<td style="text-align: left;">POLYGON ((120.5645 16.67007…</td>
<td style="text-align: right;">45</td>
</tr>
<tr class="even">
<td style="text-align: left;">Laguna</td>
<td style="text-align: left;">MULTIPOLYGON (((121.2067 14…</td>
<td style="text-align: right;">315</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Lanao del Norte</td>
<td style="text-align: left;">POLYGON ((124.2482 8.33171,…</td>
<td style="text-align: right;">21</td>
</tr>
<tr class="even">
<td style="text-align: left;">Lanao del Sur</td>
<td style="text-align: left;">POLYGON ((124.484 8.158501,…</td>
<td style="text-align: right;">28</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Leyte</td>
<td style="text-align: left;">MULTIPOLYGON (((125.1739 10…</td>
<td style="text-align: right;">61</td>
</tr>
<tr class="even">
<td style="text-align: left;">Maguindanao del Norte</td>
<td style="text-align: left;">MULTIPOLYGON (((124.4633 7….</td>
<td style="text-align: right;">32</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Maguindanao del Sur</td>
<td style="text-align: left;">POLYGON ((124.7111 7.182233…</td>
<td style="text-align: right;">24</td>
</tr>
<tr class="even">
<td style="text-align: left;">Masbate</td>
<td style="text-align: left;">MULTIPOLYGON (((122.9371 13…</td>
<td style="text-align: right;">17</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Metro Manila</td>
<td style="text-align: left;">POLYGON ((121.1036 14.53224…</td>
<td style="text-align: right;">1719</td>
</tr>
<tr class="even">
<td style="text-align: left;">Misamis Occidental</td>
<td style="text-align: left;">MULTIPOLYGON (((123.634 8.0…</td>
<td style="text-align: right;">10</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Misamis Oriental</td>
<td style="text-align: left;">POLYGON ((125.2386 8.747398…</td>
<td style="text-align: right;">64</td>
</tr>
<tr class="even">
<td style="text-align: left;">Negros Occidental</td>
<td style="text-align: left;">MULTIPOLYGON (((123.2035 11…</td>
<td style="text-align: right;">172</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Negros Oriental</td>
<td style="text-align: left;">MULTIPOLYGON (((123.3355 10…</td>
<td style="text-align: right;">37</td>
</tr>
<tr class="even">
<td style="text-align: left;">Northern Samar</td>
<td style="text-align: left;">MULTIPOLYGON (((124.3675 12…</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Nueva Ecija</td>
<td style="text-align: left;">POLYGON ((121.0633 16.13207…</td>
<td style="text-align: right;">303</td>
</tr>
<tr class="even">
<td style="text-align: left;">Nueva Vizcaya</td>
<td style="text-align: left;">POLYGON ((121.4324 16.63831…</td>
<td style="text-align: right;">16</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Occidental Mindoro</td>
<td style="text-align: left;">MULTIPOLYGON (((120.0454 13…</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="even">
<td style="text-align: left;">Oriental Mindoro</td>
<td style="text-align: left;">MULTIPOLYGON (((121.2841 12…</td>
<td style="text-align: right;">14</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Palawan</td>
<td style="text-align: left;">MULTIPOLYGON (((119.8987 12…</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="even">
<td style="text-align: left;">Pampanga</td>
<td style="text-align: left;">POLYGON ((120.7304 15.27495…</td>
<td style="text-align: right;">127</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Pangasinan</td>
<td style="text-align: left;">MULTIPOLYGON (((119.9228 16…</td>
<td style="text-align: right;">143</td>
</tr>
<tr class="even">
<td style="text-align: left;">Quezon</td>
<td style="text-align: left;">MULTIPOLYGON (((122.3057 14…</td>
<td style="text-align: right;">165</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Quirino</td>
<td style="text-align: left;">POLYGON ((122.0177 16.51702…</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="even">
<td style="text-align: left;">Rizal</td>
<td style="text-align: left;">MULTIPOLYGON (((121.4501 14…</td>
<td style="text-align: right;">163</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Samar</td>
<td style="text-align: left;">MULTIPOLYGON (((125.1508 12…</td>
<td style="text-align: right;">15</td>
</tr>
<tr class="even">
<td style="text-align: left;">Sarangani</td>
<td style="text-align: left;">MULTIPOLYGON (((125.398 6.4…</td>
<td style="text-align: right;">12</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Siquijor</td>
<td style="text-align: left;">POLYGON ((123.6122 9.300828…</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="even">
<td style="text-align: left;">Sorsogon</td>
<td style="text-align: left;">MULTIPOLYGON (((123.4823 12…</td>
<td style="text-align: right;">17</td>
</tr>
<tr class="odd">
<td style="text-align: left;">South Cotabato</td>
<td style="text-align: left;">POLYGON ((125.0954 6.532886…</td>
<td style="text-align: right;">86</td>
</tr>
<tr class="even">
<td style="text-align: left;">Southern Leyte</td>
<td style="text-align: left;">MULTIPOLYGON (((125.1739 10…</td>
<td style="text-align: right;">15</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Sultan Kudarat</td>
<td style="text-align: left;">POLYGON ((125.0068 6.711873…</td>
<td style="text-align: right;">23</td>
</tr>
<tr class="even">
<td style="text-align: left;">Sulu</td>
<td style="text-align: left;">MULTIPOLYGON (((120.6989 6….</td>
<td style="text-align: right;">21</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Surigao del Norte</td>
<td style="text-align: left;">MULTIPOLYGON (((126.0613 10…</td>
<td style="text-align: right;">9</td>
</tr>
<tr class="even">
<td style="text-align: left;">Surigao del Sur</td>
<td style="text-align: left;">MULTIPOLYGON (((126.3685 7….</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Tarlac</td>
<td style="text-align: left;">POLYGON ((120.6121 15.83029…</td>
<td style="text-align: right;">37</td>
</tr>
<tr class="even">
<td style="text-align: left;">Tawi-Tawi</td>
<td style="text-align: left;">MULTIPOLYGON (((118.4204 7….</td>
<td style="text-align: right;">19</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Zambales</td>
<td style="text-align: left;">MULTIPOLYGON (((120.2523 15…</td>
<td style="text-align: right;">45</td>
</tr>
<tr class="even">
<td style="text-align: left;">Zamboanga Sibugay</td>
<td style="text-align: left;">MULTIPOLYGON (((122.9196 7….</td>
<td style="text-align: right;">17</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Zamboanga del Norte</td>
<td style="text-align: left;">MULTIPOLYGON (((123.4132 8….</td>
<td style="text-align: right;">19</td>
</tr>
<tr class="even">
<td style="text-align: left;">Zamboanga del Sur</td>
<td style="text-align: left;">MULTIPOLYGON (((123.5583 8….</td>
<td style="text-align: right;">53</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="analysis" class="level2">
<h2 class="anchored" data-anchor-id="analysis">Analysis</h2>
<section id="data-wrangling-2" class="level3">
<h3 class="anchored" data-anchor-id="data-wrangling-2">Data wrangling</h3>
<p>Before we do any analysis, we need to generate the nearest neighbours of each province.</p>
<p>When creating spatial weights, we use row standardization (style = ‘W’), where each neighbor receives equal influence by being assigned a weight of 1 divided by the total number of neighbors. For example, if a province has four neighbours, each neighbor gets a weight of 1/4. While this approach is intuitive, it has a limitation: provinces at the edges of the Philippines (coastal areas or island provinces) have fewer neighbors than inland provinces. This means their spatial calculations are based on fewer observations, which could potentially distort the true spatial patterns in the data. More sophisticated weighting schemes exist, such as the binary weighting method (style=“B”). In an archipelagic country like the Philippines, the binary weighting method (style=“B”) might be more appropriate than row standardization (style=“W”) due to the country’s unique geographic structure. While row standardization divides the influence equally among neighbors (e.g., each of four neighbors gets 1/4 weight), this approach can distort spatial relationships in areas with few neighbors, particularly in island provinces and coastal areas. When a province has only two neighbors under row standardization, each neighbor receives a weight of 1/2, giving them disproportionately high influence compared to neighbors of provinces with many connections, where each might only receive 1/8 weight. Binary weighting addresses this by simply assigning a weight of 1 to each neighbor, regardless of how many neighbors a province has, thereby maintaining the actual strength of connections without artificially inflating the importance of neighbors just because a province has fewer of them. This approach might better represent true spatial relationships across the Philippines’ complex island geography. Hence, we will use the binary weighting method instead for this exercise.</p>
<p>Next, given that Philippines is a large archipelago made up of thousands of islands, many simple features (SF) polygons have no neighbours since they are not physically adjacent to one another, and we need to deal with that.</p>
<p>We could simply leave those islands out, but given that the entire Philippines is made up of islands of varying sizes, this would be unacceptable.</p>
<p>Thus, instead of using contiguity-based neighbours, we should use k-nearest neighbours (KNN) instead. With KNN, every province has exactly k neighbors. It captures across-water relationships and maintains connections between islands. Most importantly, it better represents actual spatial interactions in an archipelagic country.</p>
<p>Another possibility would be to use distance-based weighting. However with KNN, it ensures that every polygon has at least a set amount of neighbours, negating the possibility of a polygon not having a neighbour. Distance-based might leave some islands isolated if distance threshold is too small, or include too many neighbors if threshold is too large.</p>
<p>One way to still continue to use distance-based weighting is to use KNN to determine the max distance such that every province has at least one neighbour.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>longitude <span class="ot">&lt;-</span> <span class="fu">map_dbl</span>(province_drug_stats_all<span class="sc">$</span>geometry, <span class="sc">~</span><span class="fu">st_centroid</span>(.x)[[<span class="dv">1</span>]])</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>latitude <span class="ot">&lt;-</span> <span class="fu">map_dbl</span>(province_drug_stats_all<span class="sc">$</span>geometry, <span class="sc">~</span><span class="fu">st_centroid</span>(.x)[[<span class="dv">2</span>]])</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>coords <span class="ot">&lt;-</span> <span class="fu">cbind</span>(longitude, latitude)</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>k1 <span class="ot">&lt;-</span> <span class="fu">knn2nb</span>(<span class="fu">knearneigh</span>(coords))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in knn2nb(knearneigh(coords)): neighbour object has 21 sub-graphs</code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>k1dists <span class="ot">&lt;-</span> <span class="fu">unlist</span>(<span class="fu">nbdists</span>(k1, coords, <span class="at">longlat =</span> <span class="cn">TRUE</span>))</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(k1dists)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  24.84   41.95   49.65   60.40   66.25  385.26 </code></pre>
</div>
</div>
<p>As you can see, the max distance is 385.26km. We can use that number in our distance-based nearest neighbour calculations.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>wm_d <span class="ot">&lt;-</span> <span class="fu">dnearneigh</span>(coords, <span class="dv">0</span>, <span class="dv">386</span>, <span class="at">longlat =</span> <span class="cn">TRUE</span>)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>wm_d</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Neighbour list object:
Number of regions: 74 
Number of nonzero links: 1990 
Percentage nonzero weights: 36.34039 
Average number of links: 26.89189 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>wm_d_lw <span class="ot">&lt;-</span> <span class="fu">nb2listw</span>(wm_d, <span class="at">style =</span> <span class="st">'B'</span>)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(wm_d_lw)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Characteristics of weights list object:
Neighbour list object:
Number of regions: 74 
Number of nonzero links: 1990 
Percentage nonzero weights: 36.34039 
Average number of links: 26.89189 
Link number distribution:

 1  2  7 17 19 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 
 1  1  1  3  1  1  4  4  1  5  2  7 12  5  5  5  6  4  3  1  2 
1 least connected region:
53 with 1 link
2 most connected regions:
12 61 with 36 links

Weights style: B 
Weights constants summary:
   n   nn   S0   S1     S2
B 74 5476 1990 3980 226536</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(province_drug_stats_all<span class="sc">$</span>geometry, <span class="at">border=</span><span class="st">"lightgrey"</span>)</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(wm_d, coords, <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">cex =</span> <span class="fl">0.6</span>, <span class="at">add =</span> <span class="cn">TRUE</span>, <span class="at">col=</span> <span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<p>However, the distance between islands vary greatly as demonstrated. A single distance threshold that works for Visayas (closely spaced islands) might connect too many neighbors while Palawan to Luzon might leave some areas isolated.</p>
<p>KNN offers more control and provides more consistent spatial relationship measurements across different density areas.</p>
<p>Since we are using KNN, the parameter that matters most to us is <code>k</code>.</p>
<p>To figure out what value of <code>k</code> we should use, one method is to calculate the average contiguity (or the average number of neighbours), but since we determined calculating contiguity weights is out of the question, let’s do some sensitivity analysis instead. We are essentially guess-and-checking different <code>k</code> values, and see when does the Moran’s I value stabilise (or stops changing drastically).</p>
<p>However to do all that, we need to calculate the centroid of each province to derive a central coordinate (remember, we are not using projected coordinates here).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>longitude <span class="ot">&lt;-</span> <span class="fu">map_dbl</span>(province_drug_stats_all<span class="sc">$</span>geometry, <span class="sc">~</span><span class="fu">st_centroid</span>(.x)[[<span class="dv">1</span>]])</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>latitude <span class="ot">&lt;-</span> <span class="fu">map_dbl</span>(province_drug_stats_all<span class="sc">$</span>geometry, <span class="sc">~</span><span class="fu">st_centroid</span>(.x)[[<span class="dv">2</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Now that we have latitude and longitude, we use <code>cbind</code> to put longitude and latitude into the same object.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>coords <span class="ot">&lt;-</span> <span class="fu">cbind</span>(longitude, latitude)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Finally, we can start calculating the weights of each nearest neighbour relationship.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">k =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">10</span>, <span class="at">morans_i =</span> <span class="cn">NA</span>)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">10</span>) {</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Create knn weights</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>  nb_k <span class="ot">&lt;-</span> <span class="fu">knearneigh</span>(coords, <span class="at">k=</span>k) <span class="sc">%&gt;%</span></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">knn2nb</span>()</span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>  weights_k <span class="ot">&lt;-</span> <span class="fu">nb2listw</span>(nb_k, <span class="at">style =</span> <span class="st">'B'</span>)</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Calculate Moran's I</span></span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>  moran <span class="ot">&lt;-</span> <span class="fu">moran.test</span>(province_drug_stats_all<span class="sc">$</span>num_events, weights_k)</span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>  results<span class="sc">$</span>morans_i[results<span class="sc">$</span>k <span class="sc">==</span> k] <span class="ot">&lt;-</span> moran<span class="sc">$</span>estimate[<span class="dv">1</span>]</span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning in knn2nb(.): neighbour object has 2 sub-graphs</code></pre>
</div>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(results)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   k  morans_i
1  2 0.4831516
2  3 0.4043223
3  4 0.3350568
4  5 0.2749455
5  6 0.2480313
6  7 0.2027889
7  8 0.1984781
8  9 0.1913234
9 10 0.1713164</code></pre>
</div>
</div>
<p>The ideal <code>k</code> value seems to be 7</p>
<p>Now, let’s calculate KNN with k = 7.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>knn <span class="ot">&lt;-</span> <span class="fu">knn2nb</span>(<span class="fu">knearneigh</span>(coords, <span class="at">k=</span><span class="dv">7</span>))</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>knn</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Neighbour list object:
Number of regions: 74 
Number of nonzero links: 518 
Percentage nonzero weights: 9.459459 
Average number of links: 7 
Non-symmetric neighbours list</code></pre>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>k1dists <span class="ot">&lt;-</span> <span class="fu">unlist</span>(<span class="fu">nbdists</span>(knn, coords, <span class="at">longlat =</span> <span class="cn">TRUE</span>))</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(k1dists)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
  24.84   71.08   97.51  112.09  137.95  526.69 </code></pre>
</div>
</div>
<p>Next, <code>nb2listw</code> is used to convert the <code>nb</code> object into a spatial weights object.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>knn_lw <span class="ot">&lt;-</span> <span class="fu">nb2listw</span>(knn, <span class="at">style =</span> <span class="st">'B'</span>)</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(knn_lw)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Characteristics of weights list object:
Neighbour list object:
Number of regions: 74 
Number of nonzero links: 518 
Percentage nonzero weights: 9.459459 
Average number of links: 7 
Non-symmetric neighbours list
Link number distribution:

 7 
74 
74 least connected regions:
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 with 7 links
74 most connected regions:
1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 with 7 links

Weights style: B 
Weights constants summary:
   n   nn  S0  S1    S2
B 74 5476 518 924 14978</code></pre>
</div>
</div>
<p>Now, we can visualise the relationships between each province based on nearest neighbours to make sure that everything works correctly.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(province_drug_stats_all<span class="sc">$</span>geometry, <span class="at">border=</span><span class="st">"lightgrey"</span>)</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(knn, coords, <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">cex =</span> <span class="fl">0.6</span>, <span class="at">add =</span> <span class="cn">TRUE</span>, <span class="at">col=</span> <span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<p>If you still want to use a distance based approach to calculate nearest neighbour, feel free to run the following code:</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>knn <span class="ot">&lt;-</span> wm_d</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>knn_lw <span class="ot">&lt;-</span> wm_d_lw</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="morans-i" class="level3">
<h3 class="anchored" data-anchor-id="morans-i">Moran’s I</h3>
<p>Now here comes the fun part. We are going to do Moran’s I testing, specifically using Monte Carlo hypothesis testing. It measures how much nearby geographic areas are related in terms of a specific variable. It assesses whether similar or dissimilar values are clustered together in space or randomly distributed.</p>
<ul>
<li><p>A positive Moran’s I indicates that similar values tend to cluster</p></li>
<li><p>A negative value suggests that dissimilar values are near each other</p></li>
<li><p>A value close to zero implies no spatial autocorrelation, meaning the values are randomly distributed across space</p></li>
</ul>
<p>The values range from -1 to 1.</p>
<p>We first need to set a consistent seed to make sure that our results are reproducible across runs. Then, using <code>global_moran_perm</code> from <code>sfdep</code> we can do hypothesis testing.</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">moran.mc</span>(x,       <span class="co"># The variable you're analyzing (e.g., number of drug cases)</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>         listw,   <span class="co"># Spatial weights matrix defining neighborhood relationships</span></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>         nsim,    <span class="co"># Number of simulations for Monte Carlo test (e.g., 999)</span></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">zero.policy =</span> <span class="cn">NULL</span>,  <span class="co"># How to handle regions with no neighbors</span></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">alternative =</span> <span class="st">"greater"</span>)  <span class="co"># Type of alternative hypothesis to test</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">27</span>)</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>bperm <span class="ot">&lt;-</span> <span class="fu">moran.mc</span>(province_drug_stats_all<span class="sc">$</span>num_events, <span class="at">listw =</span> knn_lw, <span class="at">zero.policy =</span> <span class="cn">TRUE</span>, <span class="at">na.action =</span> na.omit, <span class="at">nsim =</span> <span class="dv">999</span>)</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>bperm</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Monte-Carlo simulation of Moran I

data:  province_drug_stats_all$num_events 
weights: knn_lw  
number of simulations + 1: 1000 

statistic = 0.20279, observed rank = 999, p-value = 0.001
alternative hypothesis: greater</code></pre>
</div>
</div>
<p>The Monte Carlo simulation results for Moran’s I provide strong evidence of spatial clustering in drug-related incidents across the Philippines. The positive Moran’s I value of 0.20279 indicates that provinces with similar levels of drug-related incidents tend to be located near each other, suggesting a clear pattern of spatial autocorrelation rather than random distribution. This finding is strongly supported by the observed rank of 999 out of 1000 simulations, indicating that our observed pattern is more clustered than almost all randomly generated patterns. Furthermore, the very small p-value of 0.001 suggests only a 0.1% chance that this clustering pattern could occur randomly, providing highly significant statistical evidence that the spatial distribution of drug-related incidents is influenced by geographic location. These results strongly justify the need for further spatial analysis, particularly at the local level, to better understand the geographic patterns of drug-related incidents in the Philippines.</p>
<section id="visualisation" class="level4">
<h4 class="anchored" data-anchor-id="visualisation">Visualisation</h4>
<p>To better understand our spatial analysis results, we should visualize the distribution of simulated Moran’s I values. By creating a histogram of these simulated values and marking our observed Moran’s I, we can visually assess how unusual our observed value is compared to what we would expect under spatial randomness. We’ll use R’s basic plotting functions <code>hist()</code> to create the histogram and <code>abline()</code> to add a vertical line showing our observed value.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(bperm<span class="sc">$</span>res[<span class="dv">1</span><span class="sc">:</span><span class="dv">999</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.01535737</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(bperm<span class="sc">$</span>res[<span class="dv">1</span><span class="sc">:</span><span class="dv">999</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.001663994</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(bperm<span class="sc">$</span>res[<span class="dv">1</span><span class="sc">:</span><span class="dv">999</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     Min.   1st Qu.    Median      Mean   3rd Qu.      Max. 
-0.092407 -0.042843 -0.023983 -0.015357  0.003314  0.236765 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(bperm<span class="sc">$</span>res, </span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">freq=</span><span class="cn">TRUE</span>, </span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">breaks=</span><span class="dv">20</span>, </span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab=</span><span class="st">"Simulated Moran's I"</span>)</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="dv">0</span>, <span class="at">col=</span><span class="st">"red"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>This resulting histogram shows the distribution of Moran’s I values under the null hypothesis (spatial randomness). The rightward skew indicates that even random spatial patterns tend to produce slightly positive Moran’s I values. This skewed distribution is why we use Monte Carlo simulation rather than assuming a normal distribution. Our observed value (not shown in this plot) being far to the right would further support that the spatial clustering we found is not just due to random chance.</p>
</section>
<section id="conclusion" class="level4">
<h4 class="anchored" data-anchor-id="conclusion">Conclusion</h4>
<p>These robust findings emphasize that geographic location plays a crucial role in the distribution of drug-related incidents, with neighboring provinces showing similar patterns, suggesting that interventions should consider spatial relationships rather than treating provinces in isolation. The strength and consistency of these results strongly justify further investigation into local spatial patterns to better understand the specific nature of these clusters across the Philippines, which could significantly inform targeted policy and enforcement strategies.</p>
</section>
</section>
<section id="gearys-c" class="level3">
<h3 class="anchored" data-anchor-id="gearys-c">Geary’s C</h3>
<div class="sourceCode" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">geary.mc</span>(x,       <span class="co"># The variable you're analyzing (e.g., number of drug cases)</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>         listw,   <span class="co"># Spatial weights matrix defining neighborhood relationships</span></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>         nsim,    <span class="co"># Number of simulations for Monte Carlo test (e.g., 999)</span></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">zero.policy =</span> <span class="cn">NULL</span>,  <span class="co"># How to handle regions with no neighbors</span></span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">alternative =</span> <span class="st">"greater"</span>)  <span class="co"># Type of alternative hypothesis to test</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>cperm <span class="ot">&lt;-</span> <span class="fu">geary.mc</span>(province_drug_stats_all<span class="sc">$</span>num_events, <span class="at">listw =</span> knn_lw, <span class="at">nsim =</span> <span class="dv">999</span>)</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>cperm</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Monte-Carlo simulation of Geary C

data:  province_drug_stats_all$num_events 
weights: knn_lw  
number of simulations + 1: 1000 

statistic = 1.0715, observed rank = 717, p-value = 0.717
alternative hypothesis: greater</code></pre>
</div>
</div>
<p>We are running 1001 simulations to raise the confidence of our result.</p>
<p>From our data, we have a <code>statistic</code> of 1.0715 which is the observed value of Geary C based on the actual data. Geary’s C typically ranges between 0 and 2.</p>
<ul>
<li><p>C ≈ 1 indicates no spatial autocorrelation (random spatial distribution).</p></li>
<li><p>C &lt; 1 suggests positive spatial autocorrelation (neighboring areas are more similar).</p></li>
<li><p>C &gt; 1 indicates negative spatial autocorrelation (neighboring areas are dissimilar).</p></li>
</ul>
<p>The Monte Carlo simulation results for Geary’s C reveal a different perspective on the spatial patterns of drug-related incidents in the Philippines. The Geary’s C value of 1.0715 is very close to 1, suggesting only weak positive spatial autocorrelation when comparing neighboring provinces directly. This interpretation is supported by the observed rank of 717 out of 1000 simulations, placing our observed pattern roughly in the middle of the distribution rather than at an extreme. The high p-value of 0.717 indicates a 71.7% chance that this pattern could occur under spatial randomness, well above conventional significance levels. Unlike the Moran’s I results, these Geary’s C findings suggest that when examining immediate neighbor relationships, the spatial pattern of drug-related incidents is not significantly different from what we might expect by chance. This apparent contradiction with Moran’s I results likely stems from Geary’s C’s focus on local comparisons rather than global patterns, suggesting that while broad regional patterns exist, the relationship between immediate neighbors might be more complex or variable.</p>
<p>Therefore, we might need to consider both global and local patterns using techniques like LISA statistics.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(cperm<span class="sc">$</span>res, <span class="at">freq=</span><span class="cn">TRUE</span>, <span class="at">breaks=</span><span class="dv">20</span>, <span class="at">xlab=</span><span class="st">"Simulated Geary's C"</span>)</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="dv">1</span>, <span class="at">col=</span><span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Since this histogram is approximately symmetrical around 1, this suggests almost perfect spatial randomness for Geary’s C. A symmetry around 1 suggests that there is an equal likelihood of getting slightly positive or negative spatial autocorrelation by chance. This is consistent with my earlier interpretation of the data having a weak positive spatial autocorrelation.</p>
</section>
</section>
</section>
<section id="where-are-the-main-areas-of-concentrated-drug-abuse-and-are-there-any-unusual-patterns-or-high-risk-spots" class="level1">
<h1>Where are the main areas of concentrated drug abuse, and are there any unusual patterns or high-risk spots?</h1>
<p>To identify specific areas of concentrated drug-related incidents in the Philippines, we employ two complementary local spatial analysis techniques: Local Indicators of Spatial Association (LISA) and Getis-Ord Gi* statistics. While our previous global spatial autocorrelation analysis confirmed the presence of spatial clustering across the country, these local measures allow us to pinpoint exactly where these clusters occur and distinguish between different types of spatial associations. LISA analysis helps identify not only clusters of high-value areas (hot spots) and low-value areas (cold spots) but also spatial outliers where provinces differ significantly from their neighbors. The Getis-Ord Gi* statistic complements this by specifically identifying statistically significant hot spots and cold spots, providing a comprehensive understanding of where drug-related incidents are concentrated and where they are notably absent. Together, these methods enable us to map and analyze the geographic distribution of drug-related incidents at a more granular level, crucial for targeted policy interventions.</p>
<section id="analysis-1" class="level2">
<h2 class="anchored" data-anchor-id="analysis-1">Analysis</h2>
<p>LISA identifies clusters and outliers by calculating spatial autocorrelation for individual spatial units such as provinces rather than the entire dataset, as global Moran’s I does.</p>
<p>For example, if you were analyzing the number of cases of drug use across different provinces in Philippines, LISA would allow you to identify which provinces have drug use counts that are spatially autocorrelated with neighboring provinces. It can highlight specific counties where drug use is either unusually high or low compared to their surroundings.</p>
<section id="local-indicators-of-spatial-association-lisa---anselins-local-morans-i" class="level3">
<h3 class="anchored" data-anchor-id="local-indicators-of-spatial-association-lisa---anselins-local-morans-i">Local Indicators of Spatial Association (LISA) - Anselin’s Local Moran’s I</h3>
<section id="data-wrangling-3" class="level4">
<h4 class="anchored" data-anchor-id="data-wrangling-3">Data wrangling</h4>
<p>By mapping out the p-value of Local Moran’s I (LISA), we can determine the statistical significance of the observed local spatial autocorrelation. This step is crucial because it helps distinguish between areas where the clustering or dispersion of drug cases is meaningful and areas where any observed pattern could be due to random chance.</p>
<p>To identify local spatial clusters and outliers, we’ll use the <code>localmoran()</code> function from the <code>spdep</code> package. This function calculates local Moran’s I values (Ii) for each province. It takes two main inputs: the province-level drug incident counts (zi values) and our previously created spatial weights matrix that defines each province’s neighbors and their relationships. The resulting Ii values will help us identify where significant spatial clusters or outliers exist in our drug incident data across the Philippines.</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">localmoran</span>(x,          <span class="co"># The variable you're analyzing (e.g., number of drug cases)</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>           listw,      <span class="co"># Spatial weights matrix defining neighborhood relationships</span></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">zero.policy =</span> <span class="cn">NULL</span>,    <span class="co"># How to handle regions with no neighbors</span></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">na.action =</span> na.fail,   <span class="co"># How to handle NA values</span></span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">alternative =</span> <span class="st">"two.sided"</span>,  <span class="co"># Type of alternative hypothesis</span></span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">p.adjust.method =</span> <span class="st">"none"</span>,   <span class="co"># Method for p-value adjustment</span></span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">mlvar =</span> <span class="cn">TRUE</span>,              <span class="co"># Whether to compute mean and variance</span></span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">spChk =</span> <span class="cn">NULL</span>)             <span class="co"># Spatial weights check</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>fips <span class="ot">&lt;-</span> <span class="fu">order</span>(province_drug_stats_all<span class="sc">$</span>ADM2_EN)</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>localMI <span class="ot">&lt;-</span> <span class="fu">localmoran</span>(province_drug_stats_all<span class="sc">$</span>num_events, knn_lw)</span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(localMI)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          Ii          E.Ii    Var.Ii       Z.Ii Pr(z != E(Ii))
1  0.6839405 -0.0117334671 0.7945861  0.7804323      0.4351364
2  0.6856409 -0.0090315751 0.6118514  0.8880902      0.3744922
3  0.7198863 -0.0098050710 0.6641790  0.8953578      0.3705959
4  0.5994218 -0.0141491866 0.9578465  0.6269268      0.5307072
5  0.1873232 -0.0008958409 0.0607601  0.7635796      0.4451178
6 -0.3888712 -0.0114473901 0.7752448 -0.4286570      0.6681729</code></pre>
</div>
</div>
<p>The <code>localmoran()</code> function produces five important values for each location (province in our case):</p>
<ol type="1">
<li><p>Local Moran’s I (Ii): The actual measure of local spatial autocorrelation</p></li>
<li><p>Expected Value (E.Ii): What value we would expect if there was no spatial pattern</p></li>
<li><p>Variance (Var.Ii): How much we expect the value to vary under spatial randomness</p></li>
<li><p>Z-score (Z.Ii): How many standard deviations the actual value is from what we expect</p></li>
<li><p>P-value (Pr()): The statistical significance of the spatial pattern, indicating how likely the observed pattern could occur by chance</p></li>
</ol>
<p>These values help us determine which provinces show significant spatial clustering or outlier patterns in drug-related incidents.</p>
<p>The code chunk below uses <code>printCoefmat()</code> to display the local Moran’s I statistics in a formatted table, making it easier to examine the results for each province.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">printCoefmat</span>(<span class="fu">data.frame</span>(</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>  localMI[fips,], </span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">row.names=</span>province_drug_stats_all<span class="sc">$</span>ADM2_EN[fips]),</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">check.names=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                               Ii        E.Ii      Var.Ii        Z.Ii
Abra                   6.8394e-01 -1.1733e-02  7.9459e-01  7.8043e-01
Agusan del Norte       6.8564e-01 -9.0316e-03  6.1185e-01  8.8809e-01
Agusan del Sur         7.1989e-01 -9.8051e-03  6.6418e-01  8.9536e-01
Aklan                  5.9942e-01 -1.4149e-02  9.5785e-01  6.2693e-01
Albay                  1.8732e-01 -8.9584e-04  6.0760e-02  7.6358e-01
Antique               -3.8887e-01 -1.1447e-02  7.7524e-01 -4.2866e-01
Apayao                 5.5162e-01 -1.4149e-02  9.5785e-01  5.7809e-01
Basilan                7.1113e-01 -1.1447e-02  7.7524e-01  8.2066e-01
Bataan                -2.8222e+00 -6.0469e-03  4.0983e-01 -4.3990e+00
Batangas               2.4228e+00 -8.5203e-03  5.7726e-01  3.2000e+00
Benguet                6.8258e-02 -3.8215e-03  2.5908e-01  1.4161e-01
Bohol                 -2.0017e-01 -1.9843e-03  1.3457e-01 -5.4027e-01
Bukidnon               4.9903e-01 -1.2613e-02  8.5403e-01  5.5364e-01
Bulacan                2.9540e+01 -1.1058e+00  6.3163e+01  3.8560e+00
Cagayan                9.4944e-02 -2.7703e-04  1.8791e-02  6.9464e-01
Camarines Norte       -2.0042e-01 -2.1045e-03  1.4271e-01 -5.2497e-01
Camarines Sur          4.9927e-04 -2.1960e-05  1.4896e-03  1.3505e-02
Capiz                 -4.0795e-01 -1.3835e-02  9.3661e-01 -4.0723e-01
Catanduanes            6.3945e-01 -1.4467e-02  9.7932e-01  6.6078e-01
Cavite                 1.0361e+01 -7.3807e-02  4.9538e+00  4.6881e+00
Cebu                  -3.0233e+00 -5.0617e-01  3.1853e+01 -4.4600e-01
Cotabato               1.1854e-01 -4.2560e-04  2.8868e-02  7.0018e-01
Davao de Oro           6.5137e-01 -1.2913e-02  8.7432e-01  7.1042e-01
Davao del Norte        6.0817e-01 -1.0886e-02  7.3727e-01  7.2097e-01
Davao del Sur         -1.2268e-01 -4.2264e-04  2.8667e-02 -7.2209e-01
Davao Occidental       5.3604e-01 -1.5113e-02  1.0230e+00  5.4493e-01
Davao Oriental         6.5452e-01 -1.2913e-02  8.7432e-01  7.1379e-01
Guimaras              -4.6053e-01 -1.4788e-02  1.0010e+00 -4.4551e-01
Ifugao                 5.9736e-01 -1.5113e-02  1.0230e+00  6.0556e-01
Ilocos Norte           4.9328e-01 -6.4673e-03  4.3829e-01  7.5487e-01
Ilocos Sur             2.7597e-01 -1.5391e-03  1.0438e-01  8.5897e-01
Iloilo                -9.7425e-02 -1.1503e-03  7.8018e-02 -3.4468e-01
Isabela               -2.7472e-01 -1.6393e-03  1.1117e-01 -8.1901e-01
Kalinga                5.4709e-01 -1.3835e-02  9.3661e-01  5.7960e-01
La Union               2.9900e-01 -4.1571e-03  2.8182e-01  5.7106e-01
Laguna                 1.1308e+01 -8.6589e-02  5.8010e+00  4.7307e+00
Lanao del Norte        5.0830e-01 -9.2859e-03  6.2906e-01  6.5258e-01
Lanao del Sur          5.0267e-01 -7.5799e-03  5.1361e-01  7.1197e-01
Leyte                 -5.5277e-02 -1.8677e-03  1.2666e-01 -1.5007e-01
Maguindanao del Norte  3.2360e-01 -6.6827e-03  4.5288e-01  4.9079e-01
Maguindanao del Sur    3.6696e-01 -8.5336e-03  5.7815e-01  4.9383e-01
Masbate                6.3495e-01 -1.0338e-02  7.0025e-01  7.7113e-01
Metro Manila           3.9839e+01 -4.6643e+00  1.0557e+02  4.3313e+00
Misamis Occidental     6.9457e-01 -1.2316e-02  8.3398e-01  7.7405e-01
Misamis Oriental       2.9609e-01 -1.5391e-03  1.0438e-01  9.2122e-01
Negros Occidental      1.4492e-01 -1.0871e-02  7.3626e-01  1.8156e-01
Negros Oriental       -2.9899e-01 -5.6407e-03  3.8232e-01 -4.7443e-01
Northern Samar         6.4146e-01 -1.4788e-02  1.0010e+00  6.5591e-01
Nueva Ecija            2.3189e+00 -7.7460e-02  5.1962e+00  1.0512e+00
Nueva Vizcaya         -1.6143e-02 -1.0610e-02  7.1864e-01 -6.5269e-03
Occidental Mindoro    -3.5566e+00 -1.3835e-02  9.3661e-01 -3.6607e+00
Oriental Mindoro      -3.1819e+00 -1.1165e-02  7.5614e-01 -3.6463e+00
Palawan                8.8608e-01 -1.3835e-02  9.3661e-01  9.2987e-01
Pampanga               1.5605e+00 -1.9779e-03  1.3413e-01  4.2662e+00
Pangasinan            -3.1594e-02 -4.3207e-03  2.9291e-01 -5.0394e-02
Quezon                 3.8781e+00 -9.0179e-03  6.1093e-01  4.9731e+00
Quirino                1.8947e-01 -1.4467e-02  9.7932e-01  2.0608e-01
Rizal                  3.6928e+00 -8.5203e-03  5.7726e-01  4.8716e+00
Samar                 -2.2742e-01 -1.0886e-02  7.3727e-01 -2.5218e-01
Sarangani              4.5280e-01 -1.1733e-02  7.9459e-01  5.2113e-01
Siquijor              -5.7628e-01 -1.5113e-02  1.0230e+00 -5.5483e-01
Sorsogon               5.6028e-01 -1.0338e-02  7.0025e-01  6.8190e-01
South Cotabato         5.2060e-02 -1.0002e-04  6.7843e-03  6.3326e-01
Southern Leyte        -2.9681e-01 -1.0886e-02  7.3727e-01 -3.3299e-01
Sultan Kudarat         4.0599e-01 -8.7808e-03  5.9488e-01  5.3777e-01
Sulu                   6.3915e-01 -9.2859e-03  6.2906e-01  8.1756e-01
Surigao del Norte      6.3908e-01 -1.2613e-02  8.5403e-01  7.0519e-01
Surigao del Sur        8.4777e-01 -1.4467e-02  9.7932e-01  8.7129e-01
Tarlac                -2.7081e+00 -5.6407e-03  3.8232e-01 -4.3706e+00
Tawi-Tawi              6.5403e-01 -9.8051e-03  6.6418e-01  8.1455e-01
Zambales              -2.3177e+00 -4.1571e-03  2.8182e-01 -4.3580e+00
Zamboanga del Norte    6.6912e-01 -9.8051e-03  6.6418e-01  8.3307e-01
Zamboanga del Sur      3.8401e-01 -2.8994e-03  1.9660e-01  8.7260e-01
Zamboanga Sibugay      6.7440e-01 -1.0338e-02  7.0025e-01  8.1827e-01
                      Pr.z....E.Ii..
Abra                          0.4351
Agusan del Norte              0.3745
Agusan del Sur                0.3706
Aklan                         0.5307
Albay                         0.4451
Antique                       0.6682
Apayao                        0.5632
Basilan                       0.4118
Bataan                        0.0000
Batangas                      0.0014
Benguet                       0.8874
Bohol                         0.5890
Bukidnon                      0.5798
Bulacan                       0.0001
Cagayan                       0.4873
Camarines Norte               0.5996
Camarines Sur                 0.9892
Capiz                         0.6838
Catanduanes                   0.5088
Cavite                        0.0000
Cebu                          0.6556
Cotabato                      0.4838
Davao de Oro                  0.4774
Davao del Norte               0.4709
Davao del Sur                 0.4702
Davao Occidental              0.5858
Davao Oriental                0.4754
Guimaras                      0.6560
Ifugao                        0.5448
Ilocos Norte                  0.4503
Ilocos Sur                    0.3904
Iloilo                        0.7303
Isabela                       0.4128
Kalinga                       0.5622
La Union                      0.5680
Laguna                        0.0000
Lanao del Norte               0.5140
Lanao del Sur                 0.4765
Leyte                         0.8807
Maguindanao del Norte         0.6236
Maguindanao del Sur           0.6214
Masbate                       0.4406
Metro Manila                  0.0000
Misamis Occidental            0.4389
Misamis Oriental              0.3569
Negros Occidental             0.8559
Negros Oriental               0.6352
Northern Samar                0.5119
Nueva Ecija                   0.2931
Nueva Vizcaya                 0.9948
Occidental Mindoro            0.0003
Oriental Mindoro              0.0003
Palawan                       0.3524
Pampanga                      0.0000
Pangasinan                    0.9598
Quezon                        0.0000
Quirino                       0.8367
Rizal                         0.0000
Samar                         0.8009
Sarangani                     0.6023
Siquijor                      0.5790
Sorsogon                      0.4953
South Cotabato                0.5266
Southern Leyte                0.7391
Sultan Kudarat                0.5907
Sulu                          0.4136
Surigao del Norte             0.4807
Surigao del Sur               0.3836
Tarlac                        0.0000
Tawi-Tawi                     0.4153
Zambales                      0.0000
Zamboanga del Norte           0.4048
Zamboanga del Sur             0.3829
Zamboanga Sibugay             0.4132</code></pre>
</div>
</div>
<p>To visualize our local Moran’s I results geographically, we first need to join the local Moran’s I statistics with our spatial data. We’ll add these new statistical values to our existing spatial dataframe of provinces, allowing us to create maps that show spatial clustering patterns.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>provinces.localMI <span class="ot">&lt;-</span> <span class="fu">cbind</span>(province_drug_stats_all, localMI) <span class="sc">%&gt;%</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Pr.Ii =</span> Pr.z....E.Ii..)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="visualisation-1" class="level4">
<h4 class="anchored" data-anchor-id="visualisation-1">Visualisation</h4>
<p>This code below creates a side-by-side visualization of two key aspects of our local Moran’s I analysis. The left map displays the local Moran’s I statistics for each province using a red-blue color scheme, where contrasting colors help identify clusters and outliers. The right map shows the statistical significance (p-values) of these patterns using varying shades of blue, with darker blues indicating higher statistical significance at different thresholds (0.001, 0.01, 0.05, and 0.1). The maps are arranged horizontally with equal aspect ratios, allowing us to simultaneously examine both the strength of spatial associations and their statistical significance across the Philippines. Province boundaries are shown with semi-transparent borders (alpha = 0.5) to maintain visibility of the underlying patterns while preserving provincial context.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>localMI.map <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(provinces.localMI) <span class="sc">+</span></span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="at">col =</span> <span class="st">"Ii"</span>, </span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">style =</span> <span class="st">"pretty"</span>,</span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">palette =</span> <span class="st">"RdBu"</span>,</span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">title =</span> <span class="st">"Local Moran statistics"</span>) <span class="sc">+</span></span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>)</span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a>pvalue.map <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(provinces.localMI) <span class="sc">+</span></span>
<span id="cb81-9"><a href="#cb81-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="at">col =</span> <span class="st">"Pr.Ii"</span>, </span>
<span id="cb81-10"><a href="#cb81-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">breaks=</span><span class="fu">c</span>(<span class="sc">-</span><span class="cn">Inf</span>, <span class="fl">0.001</span>, <span class="fl">0.01</span>, <span class="fl">0.05</span>, <span class="fl">0.1</span>, <span class="cn">Inf</span>),</span>
<span id="cb81-11"><a href="#cb81-11" aria-hidden="true" tabindex="-1"></a>          <span class="at">palette=</span><span class="st">"-Blues"</span>, </span>
<span id="cb81-12"><a href="#cb81-12" aria-hidden="true" tabindex="-1"></a>          <span class="at">title =</span> <span class="st">"Local Moran's I p-values"</span>) <span class="sc">+</span></span>
<span id="cb81-13"><a href="#cb81-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>)</span>
<span id="cb81-14"><a href="#cb81-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-15"><a href="#cb81-15" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_arrange</span>(localMI.map, pvalue.map, <span class="at">asp=</span><span class="dv">1</span>, <span class="at">ncol=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Variable(s) "Ii" contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-41-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
<p>The local Moran’s I (Ii) tells you the direction and strength of spatial clustering. A positive Ii means that province is similar to neighbors, which means that clustering occurs, and vice versa. If the Ii is close to zero, it means that no spatial patterns are detected. p-values tell you how statistically significant the pattern is.</p>
<p>Common thresholds:</p>
<ul>
<li><p>p &lt; 0.001: Very strong evidence</p></li>
<li><p>p &lt; 0.01: Strong evidence</p></li>
<li><p>p &lt; 0.05: Evidence</p></li>
<li><p>p &lt; 0.1: Weak evidence</p></li>
<li><p>p &gt; 0.1: No significant evidence</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(provinces.localMI) <span class="sc">+</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="at">col =</span> <span class="st">"Ii"</span>, </span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">style =</span> <span class="st">"pretty"</span>,</span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">palette =</span> <span class="st">"RdBu"</span>,</span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">title =</span> <span class="st">"Local Moran statistics"</span>) <span class="sc">+</span></span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_text</span>(<span class="st">"ADM2_EN"</span>, <span class="at">col =</span> <span class="st">"orange"</span>, <span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">remove.overlap =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Variable(s) "Ii" contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<p>In the diagram, you can see that the province of Bulacan and the national capital region exhibit high amounts of clustering, and this is supported by their high p-values of less than 0.001, which suggests a very strong evidence of clustering.</p>
<p>The provinces of Bataan, Zambales, Tarlac, and Occidental Mindoro has a very strong evidence of a low amounts of clustering, supported by their negative Ii and p-values of less than 0.001.</p>
</section>
<section id="conclusion-1" class="level4">
<h4 class="anchored" data-anchor-id="conclusion-1">Conclusion</h4>
<p>This LISA (Local Indicators of Spatial Association) analysis reveals distinct patterns of drug-related incidents in the Philippines:</p>
<p>First, Bulacan and the National Capital Region show significant high-high clustering (positive Ii with p &lt; 0.001), meaning these areas consistently have high numbers of drug-related incidents and are surrounded by other areas with similarly high numbers. This suggests a concentrated hot spot of drug-related activities in the metropolitan region, likely influenced by factors such as urban density, economic activity, and interconnected transportation networks.</p>
<p>In contrast, provinces like Bataan, Zambales, Tarlac, and Occidental Mindoro demonstrate significant low-low clustering (negative Ii with p &lt; 0.001), indicating these areas have low numbers of incidents and are surrounded by areas with similarly low numbers. This pattern is particularly interesting given some of these provinces’ proximity to the high-incident metro area, suggesting that certain geographic, socio-economic, or administrative factors might be effectively limiting the spread of drug-related activities into these regions.</p>
<p>These findings highlight the strong spatial component of drug-related incidents in the Philippines, with clear geographic patterns that could inform targeted intervention strategies and resource allocation for drug prevention and control efforts.</p>
</section>
<section id="moran-scatterplot" class="level4">
<h4 class="anchored" data-anchor-id="moran-scatterplot">Moran scatterplot</h4>
<p>In order to better understand the nature and strength of spatial relationships in drug-related incidents across provinces, we will analyze the Moran scatterplot using standardized variables. By standardizing our data, we can interpret values in terms of standard deviations from the mean, making it easier to identify significant patterns and outliers. The Moran scatterplot will display each province’s standardized drug incident rate on the x-axis against its spatially lagged standardized values (weighted average of neighboring provinces) on the y-axis. This visualization helps us identify four types of spatial associations: high-high clusters (upper-right quadrant), low-low clusters (lower-left quadrant), and spatial outliers where provinces differ significantly from their neighbors (upper-left and lower-right quadrants). Through this standardized approach, we can more intuitively interpret the relative positions of provinces and their spatial relationships.</p>
<p>First, we’ll standardize our variable using the <code>scale()</code> function. This process transforms our data by:</p>
<ol type="1">
<li><p>Centering: Subtracting the mean value from each observation</p></li>
<li><p>Scaling: Dividing each centered value by the standard deviation</p></li>
</ol>
<p>This standardization allows us to express our drug incident values in terms of how many standard deviations they are from the mean, making patterns and outliers easier to identify.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>province_drug_stats_all<span class="sc">$</span>Z.cases <span class="ot">&lt;-</span> <span class="fu">scale</span>(province_drug_stats_all<span class="sc">$</span>num_events) <span class="sc">%&gt;%</span> as.vector </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The <code>as.vector()</code> function ensures our standardized values are in a simple vector format that can be easily incorporated into our dataframe. With our data now standardized and properly formatted, we can create the Moran scatterplot to visualize spatial relationships between provinces and their neighbors.</p>
<p>This Moran scatterplot below shows drug incidents in each province (x-axis) against the average drug incidents in their neighboring provinces (y-axis), with both variables standardized (shown as z-scores). The plot reveals spatial patterns by dividing into quadrants</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">moran.plot</span>(x,          <span class="co"># The variable you're analyzing (e.g., number of drug cases)</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>           listw,      <span class="co"># Spatial weights matrix defining neighborhood relationships</span></span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">zero.policy =</span> <span class="cn">NULL</span>,    <span class="co"># How to handle regions with no neighbors</span></span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">spChk =</span> <span class="cn">NULL</span>,         <span class="co"># Spatial weights check</span></span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">labels =</span> <span class="cn">NULL</span>,        <span class="co"># Labels for points (e.g., province names)</span></span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">xlab =</span> <span class="cn">NULL</span>,         <span class="co"># Label for x-axis</span></span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">ylab =</span> <span class="cn">NULL</span>,         <span class="co"># Label for y-axis</span></span>
<span id="cb86-8"><a href="#cb86-8" aria-hidden="true" tabindex="-1"></a>           <span class="at">quiet =</span> <span class="cn">NULL</span>)        <span class="co"># Whether to suppress messages</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>nci <span class="ot">&lt;-</span> <span class="fu">moran.plot</span>(province_drug_stats_all<span class="sc">$</span>Z.cases, knn_lw,</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">labels=</span><span class="fu">as.character</span>(province_drug_stats_all<span class="sc">$</span>ADM2_EN),</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">xlab=</span><span class="st">"z-cases 2012"</span>,</span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">ylab=</span><span class="st">"Spatially Lagged z-cases"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-44-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<ul>
<li><p><strong>Upper-right (HH)</strong>: Provinces with high drug incidents near other high-incident provinces</p></li>
<li><p><strong>Lower-left (LL)</strong>: Provinces with low drug incidents near other low-incident provinces</p></li>
<li><p><strong>Lower-right (HL)</strong>: High-incident provinces surrounded by low-incident provinces (spatial outliers)</p></li>
<li><p><strong>Upper-left (LH)</strong>: Low-incident provinces surrounded by high-incident provinces (spatial outliers)</p></li>
</ul>
</section>
<section id="plotting-lisa-map" class="level4">
<h4 class="anchored" data-anchor-id="plotting-lisa-map">Plotting LISA map</h4>
<p>Let’s create a LISA (Local Indicators of Spatial Association) cluster map to visualize significant spatial clusters and outliers of drug-related incidents across provinces.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>quadrant <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">mode=</span><span class="st">"numeric"</span>,<span class="at">length=</span><span class="fu">nrow</span>(localMI))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We’ll then calculate the weighted average of drug cases in neighboring provinces (spatial lag) and standardize these values by centering them around their mean. This allows us to compare each province’s values with the average of its neighbours.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>province_drug_stats_all<span class="sc">$</span>lag_cases <span class="ot">&lt;-</span> <span class="fu">lag.listw</span>(knn_lw, province_drug_stats_all<span class="sc">$</span>num_events)</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>DV <span class="ot">&lt;-</span> province_drug_stats_all<span class="sc">$</span>lag_cases <span class="sc">-</span> <span class="fu">mean</span>(province_drug_stats_all<span class="sc">$</span>lag_cases)     </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Next, we’ll standardize the local Moran’s I values by centering them around their mean, making it easier to identify significant deviations from average spatial patterns.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>LM_I <span class="ot">&lt;-</span> localMI[,<span class="dv">1</span>] <span class="sc">-</span> <span class="fu">mean</span>(localMI[,<span class="dv">1</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s then establish a significance threshold (p-value) to determine which local Moran’s I values represent statistically significant spatial patterns.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>signif <span class="ot">&lt;-</span> <span class="fl">0.05</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s identify the four types of spatial clusters:</p>
<ul>
<li><p>Low-Low (1): Provinces with low values near other low values</p></li>
<li><p>Low-High (2): Provinces with low values near high values</p></li>
<li><p>High-Low (3): Provinces with high values near low values</p></li>
<li><p>High-High (4): Provinces with high values near other high values</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>quadrant[DV <span class="sc">&lt;</span><span class="dv">0</span> <span class="sc">&amp;</span> LM_I<span class="sc">&gt;</span><span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>quadrant[DV <span class="sc">&gt;</span><span class="dv">0</span> <span class="sc">&amp;</span> LM_I<span class="sc">&lt;</span><span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>quadrant[DV <span class="sc">&lt;</span><span class="dv">0</span> <span class="sc">&amp;</span> LM_I<span class="sc">&lt;</span><span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a>quadrant[DV <span class="sc">&gt;</span><span class="dv">0</span> <span class="sc">&amp;</span> LM_I<span class="sc">&gt;</span><span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="dv">4</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Finally, we’ll assign a value of 0 to provinces where the local Moran’s I values are not statistically significant, indicating areas with no clear spatial clustering pattern.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>quadrant[localMI[,<span class="dv">5</span>]<span class="sc">&gt;</span>signif] <span class="ot">&lt;-</span> <span class="dv">0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s create a map to visualize these LISA (Local Indicators of Spatial Association) classifications, showing where significant spatial clusters and outliers occur across the Philippines.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>cases <span class="ot">&lt;-</span> <span class="fu">qtm</span>(province_drug_stats_all, <span class="st">"num_events"</span>)</span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>provinces.localMI<span class="sc">$</span>quadrant <span class="ot">&lt;-</span> quadrant</span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>colors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"#ffffff"</span>, <span class="st">"#2c7bb6"</span>, <span class="st">"#abd9e9"</span>, <span class="st">"#fdae61"</span>, <span class="st">"#d7191c"</span>)</span>
<span id="cb94-5"><a href="#cb94-5" aria-hidden="true" tabindex="-1"></a>clusters <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"insignificant"</span>, <span class="st">"low-low"</span>, <span class="st">"low-high"</span>, <span class="st">"high-low"</span>, <span class="st">"high-high"</span>)</span>
<span id="cb94-6"><a href="#cb94-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-7"><a href="#cb94-7" aria-hidden="true" tabindex="-1"></a>LISAmap <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(provinces.localMI) <span class="sc">+</span></span>
<span id="cb94-8"><a href="#cb94-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="at">col =</span> <span class="st">"quadrant"</span>, </span>
<span id="cb94-9"><a href="#cb94-9" aria-hidden="true" tabindex="-1"></a>          <span class="at">style =</span> <span class="st">"cat"</span>, </span>
<span id="cb94-10"><a href="#cb94-10" aria-hidden="true" tabindex="-1"></a>          <span class="at">palette =</span> colors[<span class="fu">c</span>(<span class="fu">sort</span>(<span class="fu">unique</span>(quadrant)))<span class="sc">+</span><span class="dv">1</span>], </span>
<span id="cb94-11"><a href="#cb94-11" aria-hidden="true" tabindex="-1"></a>          <span class="at">labels =</span> clusters[<span class="fu">c</span>(<span class="fu">sort</span>(<span class="fu">unique</span>(quadrant)))<span class="sc">+</span><span class="dv">1</span>],</span>
<span id="cb94-12"><a href="#cb94-12" aria-hidden="true" tabindex="-1"></a>          <span class="at">popup.vars =</span> <span class="fu">c</span>(<span class="st">""</span>)) <span class="sc">+</span></span>
<span id="cb94-13"><a href="#cb94-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_view</span>(<span class="at">set.zoom.limits =</span> <span class="fu">c</span>(<span class="dv">11</span>,<span class="dv">17</span>)) <span class="sc">+</span></span>
<span id="cb94-14"><a href="#cb94-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha=</span><span class="fl">0.5</span>)</span>
<span id="cb94-15"><a href="#cb94-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-16"><a href="#cb94-16" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_arrange</span>(cases, LISAmap, </span>
<span id="cb94-17"><a href="#cb94-17" aria-hidden="true" tabindex="-1"></a>             <span class="at">asp=</span><span class="dv">1</span>, <span class="at">ncol=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-51-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
<p>Low-high: Regions with low values and neighboring regions with high values (negative deviation with positive local Moran’s I). This quadrant identifies low-value outliers surrounded by high-value areas.</p>
<p>High-low: Regions with high values and neighboring regions with low values (positive deviation with negative local Moran’s I). This quadrant identifies high-value outliers surrounded by low-value areas.</p>
<p>Low-low: Regions with low values and neighboring regions also with low values (negative deviation with negative local Moran’s I). This identifies clusters of low values, where both the region and its neighbors have similarly low values.</p>
<p>High-high: Regions with high values and neighboring regions also with high values (positive deviation with positive local Moran’s I). This identifies clusters of high values, where both the region and its neighbors have high values.</p>
<p>High-high and low-low are considered clusters. High-low and low-high are considered outliers.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(provinces.localMI) <span class="sc">+</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="at">col =</span> <span class="st">"quadrant"</span>, </span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">style =</span> <span class="st">"cat"</span>, </span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">palette =</span> colors[<span class="fu">c</span>(<span class="fu">sort</span>(<span class="fu">unique</span>(quadrant)))<span class="sc">+</span><span class="dv">1</span>], </span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">labels =</span> clusters[<span class="fu">c</span>(<span class="fu">sort</span>(<span class="fu">unique</span>(quadrant)))<span class="sc">+</span><span class="dv">1</span>],</span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">popup.vars =</span> <span class="fu">c</span>(<span class="st">""</span>)) <span class="sc">+</span></span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_text</span>(<span class="st">"ADM2_EN"</span>, <span class="at">col =</span> <span class="st">"yellow"</span>, <span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">remove.overlap =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb95-8"><a href="#cb95-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_view</span>(<span class="at">set.zoom.limits =</span> <span class="fu">c</span>(<span class="dv">11</span>,<span class="dv">17</span>)) <span class="sc">+</span></span>
<span id="cb95-9"><a href="#cb95-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha=</span><span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-52-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<p>The LISA analysis reveals a distinct spatial pattern centered around Metro Manila, where multiple provinces exhibit high-high clustering, indicating a concentrated area of drug-related incidents that spans across neighboring provinces. In contrast, provinces like Bataan, Occidental Mindoro, Bataan, Zambales, and Tarlac emerge as low-high outliers, maintaining lower incident rates despite their proximity to areas of high drug-related activity.</p>
<p>The distinct spatial patterns revealed by the LISA analysis suggest that drug-related incidents in the Philippines follow a complex geographic distribution that isn’t solely determined by proximity to high-incident areas. The strong high-high clustering around Metro Manila indicates that urban agglomeration, shared infrastructure, and interconnected socio-economic networks likely facilitate the concentration of drug-related activities in the metropolitan region.</p>
<p>However, the presence of low-high outliers (Bataan, Occidental Mindoro, Zambales, and Tarlac) demonstrates that proximity to high-incident areas doesn’t inevitably lead to high numbers of drug-related incidents. These provinces’ success in maintaining lower rates despite their location near Metro Manila’s hot spot suggests that local factors such as effective enforcement strategies, geographic barriers, or distinct socio-economic conditions can successfully mitigate the spread of drug-related activities. This finding is particularly significant as it indicates that local interventions and characteristics can overcome the influence of neighboring high-incident areas.</p>
<p>These patterns suggest that drug prevention and control strategies should be tailored to local contexts rather than assuming a one-size-fits-all approach. Understanding how these low-high outlier provinces maintain their status could provide valuable insights for developing effective intervention strategies in other regions facing similar challenges.</p>
</section>
</section>
<section id="getis-ord-gi-statistic" class="level3">
<h3 class="anchored" data-anchor-id="getis-ord-gi-statistic">Getis-Ord Gi Statistic</h3>
<p>Hotspot and coldspot analysis is a spatial statistical method used to pinpoint areas where high or low values of a specific variable cluster together geographically. It aids in uncovering significant spatial patterns, emphasizing regions where extreme values, either high or low, are concentrated.</p>
<p>We need to use data from nearest neighbour column to calculate the inverse of the distance between each neighbour.</p>
<p>Areas with higher Gi values in Getis-Ord Gi analysis represent hotspots, in which regions with a higher than expected GDP per capita cluster together. Note that hotspots and coldspots are not considered outliers.</p>
<p>Since we are using adaptive distance earlier, we will similarly use adaptive distance weights for the sake of consistency.</p>
<p>This code below calculates the Getis-Ord Gi* statistic for each province to identify significant hot spots and cold spots of drug-related incidents across the Philippines. Using our k-nearest neighbors spatial weights, the <code>localG()</code> function computes these statistics for each province based on their drug incident counts. We then append these Gi* values to our existing provincial dataset and rename the new column to ‘gstat_adaptive’, creating a comprehensive dataset that includes both our original data and the hot spot analysis results. This analysis will help us identify where significantly high or low numbers of drug-related incidents are clustering geographically.</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">localG</span>(x,           <span class="co"># The variable you're analyzing (e.g., number of drug cases)</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>       listw,       <span class="co"># Spatial weights matrix defining neighborhood relationships</span></span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>       <span class="at">zero.policy =</span> <span class="cn">NULL</span>,     <span class="co"># How to handle regions with no neighbors</span></span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">spChk =</span> <span class="cn">NULL</span>,          <span class="co"># Spatial weights check</span></span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">return_internals =</span> <span class="cn">FALSE</span>)  <span class="co"># Whether to return internal calculations</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>gi.adaptive <span class="ot">&lt;-</span> <span class="fu">localG</span>(province_drug_stats_all<span class="sc">$</span>num_events, knn_lw)</span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>cases.gi <span class="ot">&lt;-</span> <span class="fu">cbind</span>(province_drug_stats_all, <span class="fu">as.matrix</span>(gi.adaptive)) <span class="sc">%&gt;%</span></span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">gstat_adaptive =</span> as.matrix.gi.adaptive.)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s create a choropleth map using the <code>tmap</code> package to visualize where significant hot spots and cold spots of drug-related incidents are located across the Philippines. This visualization will display the Gi* statistics we calculated using our k-nearest neighbor weights, helping us identify areas with unusually high or low concentrations of drug-related incidents.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>Gimap <span class="ot">&lt;-</span> <span class="fu">tm_shape</span>(cases.gi) <span class="sc">+</span> </span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="at">col =</span> <span class="st">"gstat_adaptive"</span>, </span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">style =</span> <span class="st">"pretty"</span>, </span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">palette=</span><span class="st">"-RdBu"</span>, </span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">title =</span> <span class="st">"local Gi"</span>) <span class="sc">+</span> </span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>)</span>
<span id="cb98-7"><a href="#cb98-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-8"><a href="#cb98-8" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_arrange</span>(cases, </span>
<span id="cb98-9"><a href="#cb98-9" aria-hidden="true" tabindex="-1"></a>             Gimap, </span>
<span id="cb98-10"><a href="#cb98-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">asp=</span><span class="dv">1</span>, </span>
<span id="cb98-11"><a href="#cb98-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">ncol=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Variable(s) "gstat_adaptive" contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-54-1.png" class="img-fluid figure-img" width="1152"></p>
</figure>
</div>
</div>
</div>
<p>A high Gi value (positive z-score) indicates a hotspot, meaning the area has a concentration of high values (e.g., high number of drug cases) surrounded by other areas with similarly high values. This means that not only is the value in that area high, but the surrounding areas also exhibit high values, forming a cluster of high-intensity activity.</p>
<p>A low Gi value (negative z-score) indicates a coldspot, meaning the area has a concentration of low values surrounded by other areas with similarly low values. A low cluster suggests that the area and its neighbors are consistently below the overall average, indicating a region of low intensity.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(cases.gi) <span class="sc">+</span> </span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_fill</span>(<span class="at">col =</span> <span class="st">"gstat_adaptive"</span>, </span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>          <span class="at">style =</span> <span class="st">"pretty"</span>, </span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">palette=</span><span class="st">"-RdBu"</span>, </span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">title =</span> <span class="st">"local Gi"</span>) <span class="sc">+</span> </span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_borders</span>(<span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb100-7"><a href="#cb100-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_text</span>(<span class="st">"ADM2_EN"</span>, <span class="at">col =</span> <span class="st">"yellow"</span>, <span class="at">size =</span> <span class="fl">0.5</span>, <span class="at">remove.overlap =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Variable(s) "gstat_adaptive" contains positive and negative values, so midpoint is set to 0. Set midpoint = NA to show the full spectrum of the color palette.</code></pre>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Take-home_Ex03_files/figure-html/unnamed-chunk-55-1.png" class="img-fluid figure-img" width="960"></p>
</figure>
</div>
</div>
</div>
<p>The Getis-Ord Gi* statistics reveal a clear core-periphery pattern of drug-related incidents in the Philippines, with the highest concentrations forming a contiguous region around Metro Manila. The provinces with the highest Gi* values (4-5) form a concentrated cluster including Metro Manila and its immediately surrounding provinces, suggesting that drug-related activities are most intense in this highly urbanized, interconnected region.</p>
<p>This pattern demonstrates a clear spatial gradient, with Gi* values gradually decreasing as distance from Metro Manila increases. The moderately high values (3-4) in provinces like Occidental Mindoro, Oriental Mindoro, Batangas, and Bulacan represent a transition zone, while provinces in the Visayas region (like Antique, Capiz, Iloilo) show significantly lower values (0-1). The lowest values (-1-0) are found in the most distant provinces, indicating that the influence of Metro Manila’s drug-related patterns diminishes substantially with distance.</p>
<p>This spatial distribution strongly suggests that drug-related incidents are influenced by factors associated with urbanization, population density, and proximity to the capital region. The clear geographic pattern implies that intervention strategies should be regionally coordinated but tailored to the different intensity levels observed across the country, with particularly intensive efforts focused on the high-value cluster around Metro Manila while maintaining preventive measures in lower-value areas.</p>
</section>
</section>
</section>
<section id="conclusion-2" class="level1">
<h1>Conclusion</h1>
<p>The comprehensive spatial analysis of drug-related incidents in the Philippines demonstrates that geographic location plays a crucial role in their distribution, with clear patterns of concentration rather than random dispersion across the country. Multiple analytical methods consistently reveal a primary hot spot centered on Metro Manila and its surrounding provinces, with incident rates generally decreasing as distance from the capital region increases. However, this pattern is not uniform, as evidenced by several noteworthy exceptions such as Bataan and Occidental Mindoro, which maintain lower incident rates despite their proximity to high-incident areas, suggesting the effectiveness of local factors in mitigating drug-related activities.</p>
<p>These findings point to the need for a nuanced approach to drug prevention and control strategies. Rather than implementing uniform policies across all provinces, interventions should combine coordinated regional efforts, particularly around the Metro Manila cluster, with targeted local approaches informed by the success of outlier provinces. The clear spatial patterns indicate that resources and enforcement efforts should be strategically allocated, with intensive focus on identified hot spots while maintaining preventive measures in lower-incident areas. Additionally, the success of certain provinces in maintaining lower incident rates despite challenging geographic contexts offers valuable lessons that could be studied and potentially replicated in other regions.</p>
<p>The strong influence of geographic location on drug-related incidents, combined with the existence of successful outlier provinces, suggests that while spatial proximity to high-incident areas creates risk, it does not inevitably lead to high incident rates. This understanding should inform the development of more effective, geographically-aware intervention strategies that acknowledge both regional patterns and local capabilities in addressing drug-related challenges across the Philippines.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>